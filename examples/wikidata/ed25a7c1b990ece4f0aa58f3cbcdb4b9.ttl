@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema: <https://schema.org/> .

<https://www.wikidata.org/#query-ed25a7c1b990ece4f0aa58f3cbcdb4b9> a sh:SPARQLExecutable,
    sh:SPARQLSelectExecutable;
  rdfs:comment """ This page is an archive. Please do not modify it. Use the current page, even to continue an old discussion. Contents 1 Chemical compounds 2 Farthest north 3 comparing a string without comparing languages 4 Split a query output into two or more lists 5 List of Nigerian LGBT articles on any Wikipedia in need of translation or pictures 6 List an P31 value with a specific reference 7 QUERY TO DOWNLOAD ALL MEMBERS OF PARLIAMENTS 8 Items with DOI (P356) that start with 10.1023/A: without a Label or a title (P1476) 9 P1013:Q4167410 to P1013:Q24005632 10 First query got timeout 11 Number of generations 12 Noob looks for help 13 A Wikidata list of the articles every Wikipedia should have 14 P81 qualifiers for P197 not matching P81 statement 15 Getting the unit of a quantity 16 Russian paintings that exist on ruwiki but not on frwiki 17 Alphabetical and numberical sorting 18 Location of admin_centre of relation 19 Human settlement in Italy without description in Italian language 20 Swedish Outdoor gyms with most viewed videos on youtube 21 English creative works that have an \"has edition\" but that edition doesn't have \"edition of\" 22 Values with specific unit 23 List people born in a region and dead in nazi camps 24 Wikidata listing query 25 Eye color 26 Matching \"depicts\" wikidata item describing a file in commons with the wikidata item 27 Females billionaires 28 YouTubers who don't have an image Chemical compounds I was wanting a query for a list of chemical compounds (Q11173) that I could use in this image finding tool: https://fist.toolforge.org/wdfist/ But it causes 10% duplicates, because it fails to recognise chemical structure (P117) diagrams as images.So instance of Q11173 Without P117??? Niterurea (talk) 18:59, 2 July 2021 (UTC) @Niterurea: There's somewhere north of 1 million of them; for that reason, no labels b/c timeout. --Tagishsimon (talk) 19:07, 2 July 2021 (UTC) SELECT ?item ?itemLabel 
WHERE 
{
  ?item wdt:P31 wd:Q11173 .
  FILTER NOT EXISTS {?item wdt:P117 [] . }
#  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
}
 Try it! --Tagishsimon (talk) 19:07, 2 July 2021 (UTC) ThanksNiterurea (talk) 19:28, 2 July 2021 (UTC) Farthest north Hello, how to query, say, the city of a continent that is the farthest north ? Farthest West, East, etc ? Bouzinac‚ÄØüí¨‚óè‚úíÔ∏è‚óèüíõ 19:37, 2 July 2021 (UTC) @Bouzinac: Maybe something like this? #title: The northernmost city in Africa
SELECT ?x ?xLabel ?latitude ?longitude  WITH {

# select all the cities in a continent
SELECT ?x WHERE {
  ?x wdt:P31/wdt:P279* wd:Q515 . # x is a type of city (big city, city state etc)
  ?x wdt:P17 ?country .
  ?country wdt:P30 wd:Q15 .  # <== put the continent here
  MINUS { ?country wdt:P31 wd:Q3024240 } # current countries only
} } AS %cities

# get each city's latitude/longitude
# sort depending on east/west or north/south
# select the first one
WHERE {
  INCLUDE %cities
  ?x p:P625 [
    psv:P625 [
    wikibase:geoLatitude ?latitude ; 
    wikibase:geoLongitude ?longitude ;
      ]
    ]          
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
}     
ORDER BY DESC (?latitude)      # ASC for southernmost; DESC for northernmost
#ORDER BY ASC (?longitude)      # ASC for westernmost; DESC for easternmost
LIMIT 1
 The northernmost city in Africa Piecesofuk (talk) 14:52, 3 July 2021 (UTC)comparing a string without comparing languages SELECT ?stmt WHERE {
  wd:Q5252917 p:P1476 ?stmt.
  ?stmt ps:P1476 \"Tomorrow Is Yesterday\"@en.
}
 Try it! This tells me if Tomorrow Is Yesterday (Q5252917) has the English title \"Tomorrow Is Yesterday\". But I don't care for the language. I want to find any identical string. Just removing the @en suffix, won't yield any results. --Shisma (talk) 07:45, 4 July 2021 (UTC)I've found the answer myself: SELECT ?stmt WHERE {
  wd:Q5252917 p:P1476 ?stmt.
  ?stmt ps:P1476 ?vl.
  FILTER (str(?vl) = \"Tomorrow Is Yesterday\")
}
 Try it! --Shisma (talk) 08:45, 4 July 2021 (UTC) congrats! Sometimes it helps to spell out the question to find the answer. --- Jura 13:18, 4 July 2021 (UTC) Split a query output into two or more lists Hi:We use this query to generate eswiki anexes: SELECT DISTINCT ?item ?cod_IAPH WHERE {
  ?item (wdt:P131*) wd:Q82142;
    wdt:P8425 ?cod_IAPH.
  ?item wdt:P1435 wd:Q23712. } For technical limitations we need to limit the number of the listed elements to some number.I would like to split this query in two: the first, say, 500 elements and the second query listing the next 500 elements.Any help?--Olea (talk) 18:44, 4 July 2021 (UTC)You need to sort it by some value and then you can use offset and limit, e.g. Items used: Province of Granada (Q82142) ‚ÄØ , Bien de Inter√©s Cultural (Q23712) ‚ÄØ Properties used: located in the administrative territorial entity (P131) ‚ÄØ , IAPH code (P8425) ‚ÄØ , heritage designation (P1435) ‚ÄØ SELECT DISTINCT ?item ?cod_IAPH 
WHERE 
{
  ?item (wdt:P131*) wd:Q82142;
    wdt:P8425 ?cod_IAPH.
  ?item wdt:P1435 wd:Q23712. 
}
ORDER BY ?cod_IAPH
OFFSET 500 LIMIT 500 Try it! --- Jura 18:53, 4 July 2021 (UTC) @Jura1: Thanks! Olea (talk) 16:49, 5 July 2021 (UTC) List of Nigerian LGBT articles on any Wikipedia in need of translation or pictures Hello,Can anyone pls help with a query list of Nigerian LGBT+ articles that exists on any version of the Wikipedia and also needing images. Thanks Hadassahlove (talk) 18:46, 7 July 2021 (UTC) WD doesn't classify articles so as to indicate whether they are LGBT+ articles, nor does it know whether an article needs an image. I don't think this query is going to happen. --Tagishsimon (talk) 21:14, 7 July 2021 (UTC) List an P31 value with a specific reference Hi:I need a list (the reason is to later remove these wrong instances I made) of elements with P31 = Q4989906 value AND using an specific reference P248 = Q5917182. Thanks in advance :) --Olea (talk) 19:43, 10 July 2021 (UTC) @Olea: This: SELECT ?item ?itemLabel 
WHERE 
{
  ?item p:P31 [ps:P31 wd:Q4989906; prov:wasDerivedFrom/pr:P248 wd:Q5917182]. 
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
}
 Try it! --Tagishsimon (talk) 19:47, 10 July 2021 (UTC) @Tagishsimon: awesome! Thanks! -- Olea (talk) 20:10, 10 July 2021 (UTC) QUERY TO DOWNLOAD ALL MEMBERS OF PARLIAMENTS I am downloading the metadata of members of the Spanish Parliament. I need the following metadata:NAMES, BIRTHDATES, BIRTHPLACES, GENDERTo download this metadata I do this:`Select ?term ?member ?memberLabel ?dateBirth ?dateBirthLabel ?placeBirth ?placeBirthLabel ?sex ?sexLabel Where { # Get all CD members
 ?member wdt:P39 wd:Q18171345;
         wdt:P569 ?dateBirth;
         wdt:P19 ?placeBirth;
         wdt:P21 ?sex.
service wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],es\". }
 } But now I need to add the fact that members of parliament work in different terms (legislatures), which begin and end at different dates. In each legislature, they may belong to different political parties. Maybe the easiest is to download all members of parliament for a particular legislature \"X\" (beginning at a particular date, and ending at a particular date), In this legislature the member of parliament belongs to a political party. But I am totally INCAPABLE of doing this.Could anybody help?Best--Mcptrad (talk) 20:38, 10 July 2021 (UTC) @Mcptrad: In essence, you're asking about how to get at statement qualifiers, and the answer is somewhat like this. (I've also made lots of stuff optional, since you may not have DoB and PoB, for instance. Nor am I familiar with Spanish political seat P39 statements, so some of my choices more reflect the UK way of doing things, but yuo can see the pattern & can adjust it to suit Spain.) See also https://wdqs-tutorial.toolforge.org/index.php/category/simple-queries/qualifiers/ You'll get multiple rows for a single individual who has multiple qualifying P39 statements, so there's another job, possibly, of aggregating the data. But one thing at once. Select ?member ?memberLabel ?dateBirth ?placeBirthLabel ?sexLabel ?electoral_districtLabel ?start ?end ?parliamentary_groupLabel ?parliamentary_termLabel Where {
  ?member p:P39 ?stat . 
  ?stat ps:P39 wd:Q18171345.
  OPTIONAL {?stat pq:P580 ?start . }
  OPTIONAL {?stat pq:P582 ?end . }
  OPTIONAL {?stat pq:P768 ?electoral_district . }
  OPTIONAL {?stat pq:P4100 ?parliamentary_group . }
  OPTIONAL {?stat pq:P2937 ?parliamentary_term . }
  OPTIONAL {?member wdt:P569 ?dateBirth. }
  OPTIONAL {?member wdt:P19 ?placeBirth. }
  OPTIONAL {?member wdt:P21 ?sex. }
service wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],es\". }
 }
 Try it! --Tagishsimon (talk) 21:26, 10 July 2021 (UTC) Items with DOI (P356) that start with 10.1023/A: without a Label or a title (P1476) There are quite a few items with DOI (P356) that start with 10.1023/A: without a Label or a title (P1476). I'm not sure what is causing this. That's a problem far from my skills to resolve. I have followed the DOI of these items and added the journal article's title to the item's label and title, but there are so many. I'm not even sure one couldn't create yet another item with that DOI using SourceMD (resulting in another item to fix). Example, Q58391055 is such an item.Can someone create a list for me that has the QID and the DOI (as a link, preferably) for those items with DOI (P356) that start with 10.1023/A: without a Label or a title (P1476), I can create a table to generate a correction through QuickStatement.If anyone can prevent this from continuing to happen, it would be nice to think there's a list that I can correct and it won't continue to add new items without a title. Thank you, Trilotat (talk) 01:53, 4 July 2021 (UTC) https://www.wikidata.org/w/index.php?search=10.1023&fulltext=1&ns0=1 finds some .. Q57554778 has a title-statement, but that doesn't really help. Looks like some cleanup is needed. --- Jura 13:16, 4 July 2021 (UTC) BTW, you could also try starting out from published in (P1433): Items used: Climatic Change (Q5133623) ‚ÄØ Properties used: published in (P1433) ‚ÄØ , title (P1476) ‚ÄØ , DOI (P356) ‚ÄØ SELECT ?item ?itemLabel ?itemDescription ?doi
WHERE
{
	?item wdt:P1433 wd:Q5133623 . 
    FILTER NOT EXISTS { ?item wdt:P1476 [] } 
    OPTIONAL { ?item wdt:P356 ?doi }
	SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
} Try it! --- Jura 13:16, 4 July 2021 (UTC) @Jura1: Thank you! Hey, did you provide an example of items in that specific journal as an example? It works for me, but I was hoping for ALL journals. If you limited to items that are scholarly articles, that might limit some. Did you limit to a specific journal because otherwise it times out? Thanks again, I can address these pretty quickly now so thank you so much. Trilotat (talk) 16:05, 4 July 2021 (UTC) @Jura1: A follow-up... This is working better than expected! I have been able to update a few hundred items very quickly working through your list. I then went on to find other journals published by SpringerLink plugged into your query. Thanks so much. I'll keep looking for examples and then chasing down others published in that journal. Trilotat (talk) 17:20, 4 July 2021 (UTC) For the query, I used that journal as it was in your sample. Apparently \"10.1023\" could be any Springer publication. The below is probably closer to your question: Properties used: DOI (P356) ‚ÄØ , title (P1476) ‚ÄØ , instance of (P31) ‚ÄØ SELECT ?item ?itemLabel ?instance_of ?instance_ofLabel
WHERE
{
  BIND ( \"10.1023/A\" as ?search_string )
  hint:Query hint:optimizer \"None\".  
  SERVICE wikibase:mwapi
  {
    bd:serviceParam wikibase:endpoint \"www.wikidata.org\" .
    bd:serviceParam wikibase:api \"Generator\" .
    bd:serviceParam mwapi:generator \"search\" .
    bd:serviceParam mwapi:gsrsearch ?search_string .
    bd:serviceParam mwapi:gsrlimit \"max\" .    
    bd:serviceParam mwapi:gsrnamespace \"0\" .    
    ?item wikibase:apiOutputItem mwapi:title  .
  }
  FILTER( BOUND(?item) )
  ?item wdt:P356 ?doi 
  FILTER ( CONTAINS(?doi, ?search_string) )
  FILTER NOT EXISTS { ?item wdt:P1476 [] }   
  OPTIONAL { ?item wdt:P31 ?instance_of }
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\" }
} Try it!--- Jura 18:11, 4 July 2021 (UTC) :@Jura1: even better!! Thank you, Trilotat (talk) 04:46, 6 July 2021 (UTC) @Jura1: I've completed this update. Truth is, though, every time I run this, it seems to add previously unseen items to repair. After a few days and running it again and again, I just ran it and got NO results. I wonder how many will be on it the next time. The new items don't seem to have changed. Thanks again. Trilotat (talk) 18:30, 8 July 2021 (UTC)  SELECT (COUNT(*) as ?count) 
WHERE
{
  BIND ( \"10.1023/A\" as ?search_string )
  hint:Query hint:optimizer \"None\".  
  SERVICE wikibase:mwapi
  {
    bd:serviceParam wikibase:endpoint \"www.wikidata.org\" .
    bd:serviceParam wikibase:api \"Generator\" .
    bd:serviceParam mwapi:generator \"search\" .
    bd:serviceParam mwapi:gsrsearch ?search_string .
    bd:serviceParam mwapi:gsrlimit \"max\" .    
    bd:serviceParam mwapi:gsrnamespace \"0\" .    
    ?item wikibase:apiOutputItem mwapi:title  .
  }
} Try it! @Trilotat: it's because the mwapi search is limited to 10000 entries (which aren't always the same). These are then filtered. If you can improve the search results returned, you might get more to fix. BIND ( \"10.1023/A -haswbstatement:P1476\" as ?search_string ) wouldn't work as P1476 isn't available with haswbstatement. --- Jura 09:53, 11 July 2021 (UTC) P1013:Q4167410 to P1013:Q24005632 How would I change criterion used (P1013):Wikimedia disambiguation page (Q4167410) to criterion used (P1013):descriptive page and disambiguation page have to be in different items (Q24005632) ?First, \"criterion used\" is only used as a qualifier I think. How would I search for all P1013 qualifiers with value Q4167410? https://www.wikidata.org/wiki/Wikidata:SPARQL_tutorial#Qualifiers didn't really help. --User000name (talk) 01:49, 11 July 2021 (UTC)haswbstatement:\"P1013=Q4167410\" at https://www.wikidata.org/wiki/Special:Search?search=haswbstatement%3A%22P1013%3DQ4167410%22&fulltext=Search+for+%27Q2151613%27&fulltext=Search&ns0=1&ns120=1 didn't work. Other than \"haswbstatement\" is there something like \"haswbqualifier\"? --User000name (talk) 01:57, 11 July 2021 (UTC) @User000name: SELECT DISTINCT ?item ?itemLabel ?property
WHERE 
{
  ?stat pq:P1013 wd:Q4167410.
  ?item ?predicate ?stat .
  ?property wikibase:claim ?predicate.
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
}
 Try it! --Tagishsimon (talk) 09:05, 11 July 2021 (UTC) First query got timeout Hello everyone, I am trying to setup my first query, looking for a list of Italian enterprises with their inception date. After studying a bit I prepared thisSELECT ?item ?itemLabel ?itemDescription ?yy WHERE { ?item wdt:P571 ?yy .
   ?item wdt:P31* wd:Q6881511 .
   ?item wdt:P17* wd:Q38
         
   SERVICE wikibase:label { bd:serviceParam wikibase:language \"en,it\". } }LIMIT 10But as result it comes with a timeout error. Is there something wrong with this?thank you very much in advance for your support! I've amended your P31* to P31/P279*, since I think you're looking for anything in a particular class tree, & that's the conventional way to query for that. I've added a hint to speed that part of the query - see Wikidata:SPARQL query service/query optimization for some documentation. And P17* changed to P17, since there isn't a P17 chain of items associated with Italy - qualifying company items will have a P17 of Italy, fullstop; they won't have a value which itself has a P17=Italy statement. hth. SELECT ?item ?itemLabel ?itemDescription ?yy WHERE {
   ?item wdt:P31/wdt:P279* wd:Q6881511 .
   hint:Prior hint:gearing \"forward\".
   ?item wdt:P571 ?yy .
   ?item wdt:P17 wd:Q38         
   SERVICE wikibase:label { bd:serviceParam wikibase:language \"en,it\". }
}
 Try it! --Tagishsimon (talk) 12:58, 12 July 2021 (UTC) Number of generations Hi, How can we get the items having the longuest lineage (child (P40) chain) ? Simon Villeneuve (talk) 13:03, 13 July 2021 (UTC) I don't think Wikidata:WikiProject_Genealogy has a report for that yet, but it might not be possible. Maybe you can find it be picking one of the persons (or their parents) on Wikidata:WikiProject_Genealogy/numbers/descendants and counting number of generations. --- Jura 14:11, 13 July 2021 (UTC) SELECT (MAX(?depth) as ?max_generations) (SAMPLE(?item) as ?descendant)
WHERE
{
  SERVICE gas:service {
    gas:program gas:gasClass \"com.bigdata.rdf.graph.analytics.SSSP\" ;
                gas:in wd:Q3044 ;
                gas:traversalDirection \"Forward\" ;
                gas:out ?item ;
                gas:out1 ?depth ;
                gas:maxIterations 100 ;
                gas:linkType wdt:P40 .
  }
}
 Try it! Finds a descendant in the 42nd(?) generation of the usual suspect. He does have known parents though. --- Jura 14:19, 13 July 2021 (UTC) God! The only thing I understand in this query is wd:Q3044 and wdt:P40. Simon Villeneuve (talk) 14:26, 13 July 2021 (UTC) Items used: Elizabeth II (Q9682) ‚ÄØ Properties used: child (P40) ‚ÄØ SELECT ?item ?itemLabel ?depth 
WHERE
{
  SERVICE gas:service {
    gas:program gas:gasClass \"com.bigdata.rdf.graph.analytics.SSSP\" ;
                gas:in wd:Q9682 ;
                gas:traversalDirection \"Forward\" ;
                gas:out ?item ;
                gas:out1 ?depth ;
                gas:maxIterations 100 ;
                gas:linkType wdt:P40 .
  }
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
}
ORDER BY ?depth Try it!without MAX() and SAMPLE(), it might be easier to understand. --- Jura 14:29, 13 July 2021 (UTC) The usual suspect been beaten by about 3 times right ? Simon Villeneuve (talk) 14:32, 13 July 2021 (UTC) Maybe. Items used: Charlemagne (Q3044) ‚ÄØ Properties used: father (P22) ‚ÄØ """@en;
  dcterms:isPartOf <https://www.wikidata.org//wiki/Wikidata:Request_a_query/Archive/2021/07>;
  dcterms:license <https://creativecommons.org/licenses/by-sa/4.0/>;
  sh:prefixes _:genid-4e694113159d4e3db4a1a913894a81d820243-wikidata_prefixes;
  schema:target <https://query.wikidata.org/sparql/>;
  sh:select """PREFIX wikibase: <http://wikiba.se/ontology#>
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX wd: <http://www.wikidata.org/entity/>
PREFIX bd: <http://www.bigdata.com/rdf#>
SELECT ?item ?itemLabel ?depth 
WHERE
{
  SERVICE gas:service {
    gas:program gas:gasClass \"com.bigdata.rdf.graph.analytics.SSSP\" ;
                gas:in wd:Q3044 ;
                gas:traversalDirection \"Forward\" ;
                gas:out ?item ;
                gas:out1 ?depth ;
                gas:maxIterations 100 ;
                gas:linkType wdt:P22 .
  }
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
}
ORDER BY DESC(?depth)""" .
