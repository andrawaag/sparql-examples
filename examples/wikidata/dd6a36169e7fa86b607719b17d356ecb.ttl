@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema: <https://schema.org/> .

<https://www.wikidata.org/#query-dd6a36169e7fa86b607719b17d356ecb> a sh:SPARQLExecutable,
    sh:SPARQLSelectExecutable;
  dcterms:isPartOf <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/lb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/th>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/eu>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/en-gb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/vec>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/hy>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/id>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/be-tarask>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/tr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ro>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/he>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/zh>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/pt-br>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/si>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/eo>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/da>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ar>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ko>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/pl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ms>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/sv>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/lt>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/nl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ca>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/uk>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/it>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ja>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/es>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/cs>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ru>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/de>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/fr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/en>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples>;
  dcterms:license <https://creativecommons.org/licenses/by-sa/4.0/>;
  sh:prefixes _:genid-4e694113159d4e3db4a1a913894a81d827377-wikidata_prefixes, _:genid-4e694113159d4e3db4a1a913894a81d827377-4235312AF82EEB9AFDBAB2E04860721E,
    _:genid-4e694113159d4e3db4a1a913894a81d827377-D919827BEA74BAAC7624604E1B9F3C60, _:genid-4e694113159d4e3db4a1a913894a81d827377-C35B29D924051CCDDD12EBC6BCE288B6,
    _:genid-4e694113159d4e3db4a1a913894a81d827377-47AC3D8FAC581DB630EBB4DDE43B8184, _:genid-4e694113159d4e3db4a1a913894a81d827377-BB64D39AF0A7D53BBEDAE59B8F17E266,
    _:genid-4e694113159d4e3db4a1a913894a81d827377-0A42DFE0F989EB015D4A1C10261DB804, _:genid-4e694113159d4e3db4a1a913894a81d827377-6727CB49626AFD49C22808E29130E8DA,
    _:genid-4e694113159d4e3db4a1a913894a81d827377-330C4AA895B4FCCC5AD21F817190B74E, _:genid-4e694113159d4e3db4a1a913894a81d827377-E22AE12E166611F2EA4917DA93C3A2FA,
    _:genid-4e694113159d4e3db4a1a913894a81d827377-A39A45CE6DD5AB33102929AF06FE4F8E, _:genid-4e694113159d4e3db4a1a913894a81d827377-034580776EA997D03EC39D2179D6C1F4,
    _:genid-4e694113159d4e3db4a1a913894a81d827377-64CC6D0F01198E8AE2EE18531651882C, _:genid-4e694113159d4e3db4a1a913894a81d827377-E76B648EB2CBDC6386DC2383B171BF21,
    _:genid-4e694113159d4e3db4a1a913894a81d827377-6B48B4A8D7AEDB4F06DA297D891DEC7A, _:genid-4e694113159d4e3db4a1a913894a81d827377-2CB914D17D50325C896129DA60885490,
    _:genid-4e694113159d4e3db4a1a913894a81d827377-87089F6AB275B6BC5039F54A216D4BB3, _:genid-4e694113159d4e3db4a1a913894a81d827377-5ACCF460B583417F576BD92131A28EED,
    _:genid-4e694113159d4e3db4a1a913894a81d827377-ADE3617861F3A0739731767344F8AE0B, _:genid-4e694113159d4e3db4a1a913894a81d827377-7F1FC4CCA25AFFF7FA5A391163C24ED6,
    _:genid-4e694113159d4e3db4a1a913894a81d827377-30A29F0267A667B793CC844E5BE338D3, _:genid-4e694113159d4e3db4a1a913894a81d827377-DA754FC1CFF3E3A3518A321859085FA6,
    _:genid-4e694113159d4e3db4a1a913894a81d827377-39DB46F8A7CA87E0D0EDD3E749C4747C, _:genid-4e694113159d4e3db4a1a913894a81d827377-D55166C0E32B52894644C1153160381D,
    _:genid-4e694113159d4e3db4a1a913894a81d827377-C7BB5FE0FC4F250E953A49826F4EC3C9, _:genid-4e694113159d4e3db4a1a913894a81d827377-3552901636AF13C0D335188435E4AF33,
    _:genid-4e694113159d4e3db4a1a913894a81d827377-0B4A53EDF7C7417835149B081CD235E2, _:genid-4e694113159d4e3db4a1a913894a81d827377-49D0B823B99B4204CA79C6D128D6980F,
    _:genid-4e694113159d4e3db4a1a913894a81d827377-9AB93C6C0B7D349B4996C28108F3940A, _:genid-4e694113159d4e3db4a1a913894a81d827377-B4454DD81CD05148B6203A14F2810597,
    _:genid-4e694113159d4e3db4a1a913894a81d827377-64CA2FB674B28D4818F553D39A699C20, _:genid-4e694113159d4e3db4a1a913894a81d827377-057FC5A69D26B19CAB8CC7C4C4288B1F,
    _:genid-4e694113159d4e3db4a1a913894a81d827377-87556CD645C504DB9CB6F4D636E7D949, _:genid-4e694113159d4e3db4a1a913894a81d827377-90D2015C8F84C3D691D6C82E50326382;
  schema:target <https://query.wikidata.org/sparql/>;
  sh:select """PREFIX wikibase: <http://wikiba.se/ontology#>
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX wd: <http://www.wikidata.org/entity/>
PREFIX bd: <http://www.bigdata.com/rdf#>
# Finds authors who have published scientific articles together,
# but whose Erdos numbers are more than one apart.
# These would appear to violate the definition of the Erdos number.

SELECT
  # Q#s
  ?paper
  ?author1
  ?author2
  # title (either from title statement or label)
  (IF(BOUND(?title), ?title, ?paperLabel) AS ?title)
  # author labels (should be names) and their Erdos numbers
  ?author1Label
  ?erdos1
  ?author2Label
  ?erdos2
  # distance between Erdos numbers
  ?distance
WHERE
{
  # paper, instance of or subclass of scientific article; also has two authors
  ?paper wdt:P31/wdt:P279* wd:Q13442814;
           wdt:P50 ?author1, ?author2.
  # if it has a title, we’ll grab that as well, but it’s also okay if there’s no title
  OPTIONAL { ?paper wdt:P1476 ?title. }
  # grab Erdos numbers of the two authors
  ?author1 wdt:P2021 ?erdos1.
  ?author2 wdt:P2021 ?erdos2.
  # introduce a new variable for the difference of the Erdos numbers
  BIND(?erdos2 - ?erdos1 AS ?distance).
  # select those cases where the distance is > 1
  # (note: by *not* taking the absolute value of the distance, we avoid getting duplicated cases because the author variables might be swapped)
  FILTER(?distance > 1).
  # get *Label variables automagically
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"en\". }
}
# sort by distance first (descending), then by first author, then by second author
ORDER BY DESC(?distance) ?author1Label ?author2Label""" .
