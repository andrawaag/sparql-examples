@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema: <https://schema.org/> .

<https://www.wikidata.org/#query-0f2779a3f57a319814766f7b40139d92> a sh:SPARQLExecutable,
    sh:SPARQLSelectExecutable;
  dcterms:isPartOf <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/lb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/th>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/eu>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/en-gb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/vec>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/hy>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/id>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/be-tarask>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/tr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ro>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/he>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/zh>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/pt-br>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/si>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/eo>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/da>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ar>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ko>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/pl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ms>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/sv>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/lt>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/nl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ca>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/uk>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/it>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ja>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/es>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/cs>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ru>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/de>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/fr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/en>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples>;
  dcterms:license <https://creativecommons.org/licenses/by-sa/4.0/>;
  sh:prefixes _:genid-4e694113159d4e3db4a1a913894a81d819808-wikidata_prefixes, _:genid-4e694113159d4e3db4a1a913894a81d819808-A74748B540A9EFE46408AC5DF263843E,
    _:genid-4e694113159d4e3db4a1a913894a81d819808-E5A2A04F8BE0CEFE657303BE220AD0F4, _:genid-4e694113159d4e3db4a1a913894a81d819808-C5BBAC2186B9033A17E0D6C15D9486E8,
    _:genid-4e694113159d4e3db4a1a913894a81d819808-C9280BE5806385763FCE4B54C5051585, _:genid-4e694113159d4e3db4a1a913894a81d819808-833827FDE20FCFCFBC999A7A9B77174B,
    _:genid-4e694113159d4e3db4a1a913894a81d819808-4E88583E6D871451C7F1B961DD40D114, _:genid-4e694113159d4e3db4a1a913894a81d819808-70323FA149ACA164789E551C3151FEF6,
    _:genid-4e694113159d4e3db4a1a913894a81d819808-CA4F95A17D57EBAB8F65635660D275BE, _:genid-4e694113159d4e3db4a1a913894a81d819808-679954DD4B343CE95D42C95880D87B0B,
    _:genid-4e694113159d4e3db4a1a913894a81d819808-C0C2703B3E45D7D651BF2A97DF43342D, _:genid-4e694113159d4e3db4a1a913894a81d819808-976BD6EB99C0D4479FF77F49507A2667,
    _:genid-4e694113159d4e3db4a1a913894a81d819808-BE4EED730CE3C90483D6A1D62F401829, _:genid-4e694113159d4e3db4a1a913894a81d819808-04014767CECB899C0E88F6E9202F4EA7,
    _:genid-4e694113159d4e3db4a1a913894a81d819808-B63E4A594489EF8EF6AD8EC21F4AC468, _:genid-4e694113159d4e3db4a1a913894a81d819808-52CBA3B65214B5F51CFCD62572F2A311,
    _:genid-4e694113159d4e3db4a1a913894a81d819808-8FC39A775637C8A7BAD24D3C9BEE1043, _:genid-4e694113159d4e3db4a1a913894a81d819808-A83FF984028B5E7C907E9073D77D7F2D,
    _:genid-4e694113159d4e3db4a1a913894a81d819808-60FD38A9CE2A1475B97F51A9BEDA5A69, _:genid-4e694113159d4e3db4a1a913894a81d819808-F481207440595A75860F6474284EC996,
    _:genid-4e694113159d4e3db4a1a913894a81d819808-DC2C5B377F0947E2CEB679C6A1DE1A8F, _:genid-4e694113159d4e3db4a1a913894a81d819808-4C3D5C1A6F6421837CC849F34F0EE08B,
    _:genid-4e694113159d4e3db4a1a913894a81d819808-9173621EF5417AEC5DF2247B4E90A67B, _:genid-4e694113159d4e3db4a1a913894a81d819808-61A83FB852D64A54E6F24178E3B3F38C,
    _:genid-4e694113159d4e3db4a1a913894a81d819808-EB90720760C90C5D2ABF5C496100E4B2, _:genid-4e694113159d4e3db4a1a913894a81d819808-345DB64B8AB7D245F6C845431F6A5DC9,
    _:genid-4e694113159d4e3db4a1a913894a81d819808-E2960763E3C5EA185C0AFC738B6380CC, _:genid-4e694113159d4e3db4a1a913894a81d819808-CDE3D44544434151A101EE8F64AD9C9A,
    _:genid-4e694113159d4e3db4a1a913894a81d819808-7CD8C84FF7664078A47B72F2478A358E, _:genid-4e694113159d4e3db4a1a913894a81d819808-7139891DF3CD4F74C4BB16943BC574D3,
    _:genid-4e694113159d4e3db4a1a913894a81d819808-947484F9247C76A2AD017FE962749455, _:genid-4e694113159d4e3db4a1a913894a81d819808-2F732D7CF8F18A7E7F0D0D4A86FCFAA1,
    _:genid-4e694113159d4e3db4a1a913894a81d819808-6C1EFBE3D72ECBEFFDCD833608A26D7F, _:genid-4e694113159d4e3db4a1a913894a81d819808-37281560279751E139FCA0BCC91E0309;
  schema:target <https://query.wikidata.org/sparql/>;
  sh:select """PREFIX wikibase: <http://wikiba.se/ontology#>
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX wd: <http://www.wikidata.org/entity/>
PREFIX ps: <http://www.wikidata.org/prop/statement/>
PREFIX pq: <http://www.wikidata.org/prop/qualifier/>
PREFIX p: <http://www.wikidata.org/prop/>
PREFIX bd: <http://www.bigdata.com/rdf#>
SELECT ?awardCount ?award ?awardLabel WHERE {
  {
    SELECT (COUNT(?award) AS ?awardCount) ?award
    WHERE
    {
      {
        SELECT (SAMPLE(?human) AS ?human) ?award ?awardWork (SAMPLE(?director) AS ?director) (SAMPLE(?awardEdition) AS ?awardEdition) (SAMPLE(?time) AS ?time) WHERE {
          ?award wdt:P31 wd:Q19020 .      # All items that are instance of(P31) of Academy awards (Q19020)
          {
            ?human p:P166 ?awardStat .              # Humans with an awarded(P166) statement
            ?awardStat ps:P166 ?award .        # ... that has any of the values of ?award
            ?awardStat pq:P805 ?awardEdition . # Get the award edition (which is \"subject of\" XXth Academy Awards)
            ?awardStat pq:P1686 ?awardWork . # The work they have been awarded for
            ?human wdt:P31 wd:Q5 .        # Humans
          } UNION {
            ?awardWork wdt:P31 wd:Q11424 . # Films
            ?awardWork p:P166 ?awardStat . # ... with an awarded(P166) statement
            ?awardStat ps:P166 ?award .        # ... that has any of the values of ?award
            ?awardStat pq:P805 ?awardEdition . # Get the award edition (which is \"subject of\" XXth Academy Awards)
          }
          OPTIONAL {
            ?awardEdition wdt:P585 ?time . # the \"point of time\" of the Academy Award
            ?awardWork wdt:P57 ?director .
          }
        }
        GROUP BY ?awardWork ?award # We only want every movie once for a category (a 'random' person is selected)
      }
    } GROUP BY ?award
    ORDER BY ASC(?awardCount)
  }
  SERVICE wikibase:label { # ... include the labels
    bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],mul,en\" .
  }
}""" .
