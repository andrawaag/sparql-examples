@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema: <https://schema.org/> .

<https://www.wikidata.org/#query-500b9ab1b7f810327951e3e176e4efab> a sh:SPARQLExecutable,
    sh:SPARQLSelectExecutable;
  dcterms:isPartOf <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/lb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/th>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/eu>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/en-gb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/vec>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/hy>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/id>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/be-tarask>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/tr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ro>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/he>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/zh>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/pt-br>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/si>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/eo>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/da>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ar>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ko>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/pl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ms>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/sv>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/lt>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/nl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ca>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/uk>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/it>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ja>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/es>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/cs>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ru>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/de>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/fr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/en>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples>;
  dcterms:license <https://creativecommons.org/licenses/by-sa/4.0/>;
  sh:prefixes _:genid-4e694113159d4e3db4a1a913894a81d814849-wikidata_prefixes, _:genid-4e694113159d4e3db4a1a913894a81d814849-A4196265A4FDD93C47719EBB1DA0089C,
    _:genid-4e694113159d4e3db4a1a913894a81d814849-9E7C99B66C378BB69F9F46C1B3809ED1, _:genid-4e694113159d4e3db4a1a913894a81d814849-35AD5DC5887EC5B4CD4E0254102C94C9,
    _:genid-4e694113159d4e3db4a1a913894a81d814849-3F0C3B00FAADFB35A2E94681A8163681, _:genid-4e694113159d4e3db4a1a913894a81d814849-7B45D0B5B6B6902F05E887277FA4745B,
    _:genid-4e694113159d4e3db4a1a913894a81d814849-A7B1982CCCA5D25BAA02FB8D30323A0E, _:genid-4e694113159d4e3db4a1a913894a81d814849-8579FA703857BCF960928A336557F687,
    _:genid-4e694113159d4e3db4a1a913894a81d814849-4DE285C5DE1D8A1B257BC6DFBF6B82CB, _:genid-4e694113159d4e3db4a1a913894a81d814849-854AFEF2FD42BAAF6837DDD1A7A2A6B0,
    _:genid-4e694113159d4e3db4a1a913894a81d814849-04E02471588C0BFDA9A1EB2FD5E29424, _:genid-4e694113159d4e3db4a1a913894a81d814849-E9A224A34ADE5B7CB03B220DE71EAC41,
    _:genid-4e694113159d4e3db4a1a913894a81d814849-23AB5E49626919A23E68011F1F76DA27, _:genid-4e694113159d4e3db4a1a913894a81d814849-CB717FEB106877DF2EA1D897716D3712,
    _:genid-4e694113159d4e3db4a1a913894a81d814849-017B4635C3BF4E61A735EF775F16BE3D, _:genid-4e694113159d4e3db4a1a913894a81d814849-6B0FA6577AD4620F7C236B1C5E040FA9,
    _:genid-4e694113159d4e3db4a1a913894a81d814849-D750C129D2C352F414205B03DCE04E12, _:genid-4e694113159d4e3db4a1a913894a81d814849-1521962A315ECCC5735EC11F59D22862,
    _:genid-4e694113159d4e3db4a1a913894a81d814849-3EFD120BF7DF7B8910A21EA43C052EC9, _:genid-4e694113159d4e3db4a1a913894a81d814849-B5621A00D41193BB6C69FD134EF1AD6D,
    _:genid-4e694113159d4e3db4a1a913894a81d814849-9FB61BAE3B0328A6BC2A104F53EE8384, _:genid-4e694113159d4e3db4a1a913894a81d814849-A00FB384E6D1A659D6339D8ABF188CC6,
    _:genid-4e694113159d4e3db4a1a913894a81d814849-85952AF7CC9E2F25494008055FD30B91, _:genid-4e694113159d4e3db4a1a913894a81d814849-DE43624F24A03CAF0C02F391B3C67342,
    _:genid-4e694113159d4e3db4a1a913894a81d814849-4DEF7D20DBABD024537501D5C6B4DD64, _:genid-4e694113159d4e3db4a1a913894a81d814849-FE89C8F626BF6C0C2C0794843C6E14EB,
    _:genid-4e694113159d4e3db4a1a913894a81d814849-3D84BBC77BFC31494883B92E72C625B2, _:genid-4e694113159d4e3db4a1a913894a81d814849-ACC68CCA9DB8167F7F5E433C63D80DAA,
    _:genid-4e694113159d4e3db4a1a913894a81d814849-638E5AA381E6F37987F47263B1D977AB, _:genid-4e694113159d4e3db4a1a913894a81d814849-53CA37B2B51731A1D1AD9CA4196631F5,
    _:genid-4e694113159d4e3db4a1a913894a81d814849-B36216EC0D8FA2D28072BF3BAA324789, _:genid-4e694113159d4e3db4a1a913894a81d814849-70531E56E7ADCB748095BC6640D49F5F,
    _:genid-4e694113159d4e3db4a1a913894a81d814849-C823847CA0C0CF75903B2FA2A95995F2, _:genid-4e694113159d4e3db4a1a913894a81d814849-1EFA28C5AA252123CFFAF32340612E6A;
  schema:target <https://query.wikidata.org/sparql/>;
  sh:select """PREFIX wikibase: <http://wikiba.se/ontology#>
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX wd: <http://www.wikidata.org/entity/>
PREFIX schema: <http://schema.org/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX bd: <http://www.bigdata.com/rdf#>
SELECT ?director ?director_label ?films ?sitelinks ((?films * ?sitelinks) as ?rank)
WHERE {
  {SELECT ?director (count(DISTINCT ?film) as ?films) (count(DISTINCT ?sitelink) as ?sitelinks)
     WHERE {
       ?director wdt:P106 wd:Q2526255 .         # has \"film director\" as occupation
     ?film wdt:P57 ?director .            # get all films directed by the director
       ?sitelink schema:about ?director .       # get all the sitelinks about the director
       } GROUP BY ?director }
SERVICE wikibase:label {
  bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],mul,en\". # Get label if it exists
?director rdfs:label ?director_label }
} ORDER BY DESC(?rank)
LIMIT 100""" .
