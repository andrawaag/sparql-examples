@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema: <https://schema.org/> .

<https://www.wikidata.org/#query-e6238801cb5bc972238fa93581e34b05> a sh:SPARQLExecutable;
  rdfs:comment """Змінні позначаються префіксами ? або $. SPARQL Optimization strategies Contents 1 Загальне 1.1 Корисні посилання 1.2 Лайфхаки 2 Елементи SPARQL 2.1 Триплети 2.2 Префікси 2.3 Запит SELECT 2.3.1 Опис 2.3.2 Підзапити (вкладені запити) 2.3.3 Приклади запису змінних результату запиту 2.4 WITH, INCLUDE 2.5 Агрегатування 2.5.1 Послідовність агрегатування, GROUP BY, HAVING 2.5.2 Агрегатні функції 2.6 Expressions, FILTER, BIND, COALESCE 2.7 OPTIONAL 2.8 Робота з назвами (Labels), SERVICE 2.9 MINUS 2.10 Час 3 Запити WDQS для властивостей Вікіданих 3.1 Шляхи властивостей 3.2 Приклади 4 Примітки Загальне [edit] Корисні посилання [edit] Запити на допомогу у створенні запиту (Get count of statements for specified property) Вікідані:Глосарій SPARQL RDF Query Language Reference v1.7 (на чотирьох сторінках) ЧаПи (en) на thefigtrees.net User:Research_Bot (ботовласник) — багато різноманітних запитів SPARQL та інструментів Категорія: SPARQL query service Вікіпедія:Проект:Вікідані (uk) Chapter 2: Querying Linked Data (розділ про SPARQL) «Проміжні вузли» (blank nodes) — щодо [ ] і _:. Два символи [] можна використати замість імені змінної, яка ніде не буде використовуватися; тобто якщо якась змінна зустрічається тільки в одному місці, то її можна замінити на [] і від цього результат запиту не зміниться. Наприклад, :x :q [ :p \"v\" ] . еквівалентно двом триплетам: :x :q _:b57 . _:b57 :p \"v\" . Щодо ключового слова a див. 4.1. Класи string-функції з регулярними виразами, Regex-syntax, sparql func regex. FILTER REGEX(?name, \"^ali\", \"i\"). Взірці використання REPLACE в SPARQL-запиті: 1-й, 2-й, 3-й (в SELECT) Нормативні посилання (www.w3.org) SPARQL Query Language for RDF (W3C Recommendation 15 January 2008) SPARQL 1.1 Overview (W3C Recommendation 21 March 2013) Функції та оператори (XPath and XQuery Functions and Operators 3.1, W3C Recommendation 21 March 2017) SPARQL на wikidata.org, wikibooks.org, wikimedia.org Підручник SPARQL на wikidata.org Сервіс запитів SPARQL на wikidata.org Підручник SPARQL на en.wikibooks.org Шаблон SPARQL на wikidata.org File:SPARQL_data_representation.png (commons.wikimedia.org) Wikibase (усі сторінки, що починаються з Wikibase): Wikibase / Indexing / RDF Dump Format Wikibase / DataModel / JSON Слайди(!): Шпаргалка з SPARQL (з текстом окремо). Вступ до SPARQL (з текстом окремо). Урок SPARQL (з текстом окремо). RDF: what and why plus a SPARQL tutorial (з текстом окремо). Вступ до RDF і SPARQL (SPARQL — з 22-го слайда). Запити uk-статті з позначкою (badge) \"перевірена\" Q20748093 (див. також: wikibase:badge; посилання на Q17442550) Лайфхаки [edit] BIND(xsd:integer(?sub) as ?int). # формування цілочислової ?int з літерної ?sub
  BIND(xsd:integer(SUBSTR(STR(?item), 33)) as ?num) . # у ?num є число - номер елемента (наприклад, число 5 для Q5)
  VALUES ?item { wd:Q1936266 wd:Q1038416 wd:Q414874 wd:Q408023 ...} # формування ?item з декількох значень
  OPTIONAL {?p schema:description ?d FILTER (LANG (?d) = \"uk\") .}   +   FILTER (!BOUND(?p)) = спосіб 
    отримати всі ?p, що не мають опису на \"uk\"

     FILTER NOT EXISTS { [] schema:about ?item ; schema:isPartOf <https://uk.wikipedia.org/> } = спосіб
       отримати всі ?item, в яких відсутні посилання на ukwiki
     FILTER((!BOUND(?d)) && (BOUND(?d2))).
     FILTER NOT EXISTS { ... }
     ?item (p:P1766|p:P41|p:P4004) [?qual []] . # що це - (p:P1766|p:P41|p:P4004) - використання АБО?
     ?item p:P38/a wdno:P38 # що це - wdno:  і   p:P38/a wdno:P38  ?
     MINUS { ?item ^schema:about/schema:isPartOf <https://cs.wikipedia.org/> } . # що це - \"^\" ?

 DISTINCT # гарантує, що кожен рядок таблиці-результату буде унікальним Оптимізація запитів SPARQL: сторінка Wikidata:SPARQL query service/query optimization; щодо ролі ORDER BY (ORDER BY ?something LIMIT 29000 виконується, а LIMIT 29000 - не встигає) інвертована форма. Пряма форма (?child wdt:P22 wd:Q1339) й інвертована форма (wd:Q1339 ^wdt:P22 ?child) дають однакові результати, але інвертована форма може бути набагато швидшою. Приклад запиту (wd:Q9053464 (^pq:P361/^p:P1014)* ?item .); ще приклад (# ?item (p:P1014/pq:P361)* wd:Q1065579 . very very slow || wd:Q1065579 (^pq:P361/^p:P1014)* ?item . # much quicker). Цікаво, це wd:Q22671 ^ps:P171/^p:P171    ?pFamily .
 ?pFamily (^ps:P171/^p:P171)+  ?p .
 wd:Q7432  ^ps:P105/^p:P105    ?p . працює швидше, ніж wd:Q22671 (^ps:P171/^p:P171)+ ?p .
 wd:Q7432  ^ps:P105/^p:P105    ?p . Елементи SPARQL [edit] Триплети [edit] Триплет (triple): суб'єкт + предикат + об'єкт subject + predicate + object (SPO) підмет + присудок + додаток Див. також SPARQL: Triples. Префікси [edit] Префікси (див. RDF Dump Format: Prefixes used, а також RDF Dump Format: Predicates — щодо префіксів у предикатах) для тверджень — p: ps: psv:, для кваліфікаторів — pq: (див. Вікідані:Підручник із SPARQL. Кваліфікатори, RDF Dump Format: Statement representation) p: наприклад, p:P2 для властивості P2, вказує не на об'єкт, а на вузол твердження (statement node); вузол твердження представляє собою одне твердження щодо сутності і має тип wikibase:Statement; твердження може містити ранг, просте значення (див. ps: нижче) твердження, посилання на повне значення, кваліфікатори та посилання. ps: предикатом з таким префіксом і ім'ям властивості (наприклад ps:P2) представляють просте значення (simple value) твердження, об'єктом є просте значення;  ?item p:P4812/ps:P4812 ?P4812value . # тут поєднано  p:  і  ps:  з однаковим P4812 - що це означає?
 # p:P4812/ps:P4812 ≡ wdt:P4628 або, щонайменше, p:P4812/ps:P4812 ≈ wdt:P4628 (перевірено підстановкою 
 # wdt:P4628 в приклад запиту нижче)
 Аналіз результатів двох близьких запитів за темою питання: приклад 1 з p:P4628/ps:P4628 повертає в ?ictv, наприклад, таке: wd:Q9094478, а в приклад 2 з p:P4628 (без /ps:P4628) - таке: wds:Q29002673-E79238AA-01E5-4AC1-B5B7-05A57A52BDA0 (але кількість результатів однакова) psv: повне значення, full value (якщо цього вимагає тип) представлено предикатом з префіксом psv: (наприклад, psv:P2), а об'єктом є вузол повного значення (full value node). pq: The qualifiers are represented by predicates with prefix pq: and the name of the property (e.g. pq:P2) and the object being the simple value of the qualifier. prov:wasDerivedFrom див. Вікідані:Підручник із SPARQL. Кваліфікатори, RDF Dump Format / References / Джерела, приклад застосування wd: сутність Вікібази — елемент або властивість (наприклад, wd:Q2); wds: вузол твердження (statement node), описує вислів (claim) про сутність (наприклад, wds:Q2-82a6e009-4f93-28dc-3555-38bbfc3afe6a); wdt: з назвою властивості (наприклад, wdt:P9, wd:Q2 wdt:P9 <http://acme.com/>) застосовується у предикатах істинних тверджень (truthy statement predicates)[1], в яких об'єктом є просте значення[2] для твердження (кваліфікатори ігноруються!). ?p rdfs:label    ?pLabel .   # ?pLabel - Назва елемента ?p
  ?p skos:altLabel ?alias .    # ?alias - Інші назви елемента ?p
schema:
  ?item schema:description ?descr .         # ?descr - всі наявні описи для елементів Вікіданих ?item приклад для schema:description ?sitelink schema:name ?wikiarticle_title .    # ?wikiarticle_title - назви статей сайтів (проектів) Вікімедіа
        # для відповідних посилань ?sitelink на ці статті
        # приклад ?wikiarticle_title: Wikipedia:Brudnopis/Wikidane приклад для schema:name """@en;
  dcterms:isPartOf <https://www.wikidata.org//wiki/User:Renamerr/SPARQL>;
  dcterms:license <https://creativecommons.org/licenses/by-sa/4.0/>;
  sh:prefixes _:wikidata_prefixes;
  schema:target <https://query.wikidata.org/sparql/> .
