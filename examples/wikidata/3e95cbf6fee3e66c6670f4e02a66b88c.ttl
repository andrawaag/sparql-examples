@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema: <https://schema.org/> .

<https://www.wikidata.org/#query-3e95cbf6fee3e66c6670f4e02a66b88c> a sh:SPARQLExecutable,
    sh:SPARQLSelectExecutable;
  dcterms:isPartOf <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/lb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/th>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/eu>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/en-gb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/vec>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/hy>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/id>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/be-tarask>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/tr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ro>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/he>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/zh>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/pt-br>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/si>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/eo>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/da>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ar>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ko>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/pl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ms>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/sv>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/lt>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/nl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ca>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/uk>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/it>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ja>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/es>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/cs>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ru>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/de>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/fr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/en>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples>;
  dcterms:license <https://creativecommons.org/licenses/by-sa/4.0/>;
  sh:prefixes _:genid-4e694113159d4e3db4a1a913894a81d832891-wikidata_prefixes, _:genid-4e694113159d4e3db4a1a913894a81d832891-62EDAFFE6AA6DA4FCF1E8FB5BD2DBFC1,
    _:genid-4e694113159d4e3db4a1a913894a81d832891-378B1340AF3FD1CBA1E182DDD56A0DCA, _:genid-4e694113159d4e3db4a1a913894a81d832891-CBEB00469F55A2FFF47F2B283FA2510F,
    _:genid-4e694113159d4e3db4a1a913894a81d832891-FBE09DB2C1D667BD9F25C6E8B4FBFC37, _:genid-4e694113159d4e3db4a1a913894a81d832891-1E94048EB2C326AC08F4302F6DCC3A41,
    _:genid-4e694113159d4e3db4a1a913894a81d832891-321580E95F16B545AD9EE8E443116F14, _:genid-4e694113159d4e3db4a1a913894a81d832891-E1BA6865CEB726DC3647D931AF383264,
    _:genid-4e694113159d4e3db4a1a913894a81d832891-F7915FFBEF2E52D3C203602C9B7D913A, _:genid-4e694113159d4e3db4a1a913894a81d832891-4E9EF87C12763F20AC9226157E14600B,
    _:genid-4e694113159d4e3db4a1a913894a81d832891-AA82C705C188C84EE267A8D0AE4D3B76, _:genid-4e694113159d4e3db4a1a913894a81d832891-0785A9A9EFD67215E5ED872053629814,
    _:genid-4e694113159d4e3db4a1a913894a81d832891-8194B75E00B7325362C0594230463654, _:genid-4e694113159d4e3db4a1a913894a81d832891-1F43A5E8023B149A8BEB5A276BBF2F01,
    _:genid-4e694113159d4e3db4a1a913894a81d832891-8BE450F141049FC1B95EF93EE471E36D, _:genid-4e694113159d4e3db4a1a913894a81d832891-26176115BB610F4ECF18FFE16BCA8A26,
    _:genid-4e694113159d4e3db4a1a913894a81d832891-DE5E2303065A69A1ADACE921EBECDC94, _:genid-4e694113159d4e3db4a1a913894a81d832891-8802AC815ABAE3C1C7CFE5FBB1F5D53F,
    _:genid-4e694113159d4e3db4a1a913894a81d832891-3FC9402938514F195AA940078770D933, _:genid-4e694113159d4e3db4a1a913894a81d832891-6AF55C85613FC976FA80B1AFD1AF67F8,
    _:genid-4e694113159d4e3db4a1a913894a81d832891-FD8C08464341CFFC5EF902CD71FAA185, _:genid-4e694113159d4e3db4a1a913894a81d832891-3BF9E3E7A8D7C6AC1FC9E0CC245622C8,
    _:genid-4e694113159d4e3db4a1a913894a81d832891-AEA2F8A8661FD5A1D49771B6F0672661, _:genid-4e694113159d4e3db4a1a913894a81d832891-61AC91119021B95BC1A97419FE0280BF,
    _:genid-4e694113159d4e3db4a1a913894a81d832891-2317C1AF212145D9223B4F3ABEAEE079, _:genid-4e694113159d4e3db4a1a913894a81d832891-78B06411A900A67C36CBCF347C998941,
    _:genid-4e694113159d4e3db4a1a913894a81d832891-2675C6A7310BC7CBD6AC4D752F3DCF96, _:genid-4e694113159d4e3db4a1a913894a81d832891-FDAE0A57B61E84F46710B61214E49628,
    _:genid-4e694113159d4e3db4a1a913894a81d832891-2CC9429D40344BCCF97860A446435674, _:genid-4e694113159d4e3db4a1a913894a81d832891-DC554DB9EAC0EAF03ADE560998F4C662,
    _:genid-4e694113159d4e3db4a1a913894a81d832891-58363C2A2EA6134D3D7D9961727B8D01, _:genid-4e694113159d4e3db4a1a913894a81d832891-E6793881D808A0BEEC4A004B61418615,
    _:genid-4e694113159d4e3db4a1a913894a81d832891-23FB3F3A37FCDB2442B667E237D6E5BE, _:genid-4e694113159d4e3db4a1a913894a81d832891-BB2009B6CEDA90D3DDAF3F757C6B3B6F;
  schema:target <https://query.wikidata.org/sparql/>;
  sh:select """PREFIX wikibase: <http://wikiba.se/ontology#>
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX wd: <http://www.wikidata.org/entity/>
PREFIX psv: <http://www.wikidata.org/prop/statement/value/>
PREFIX ps: <http://www.wikidata.org/prop/statement/>
PREFIX p: <http://www.wikidata.org/prop/>
PREFIX geo: <http://www.opengis.net/ont/geosparql#>
PREFIX bd: <http://www.bigdata.com/rdf#>
#TEMPLATE={\"template\":\"metro station of ?city\",\"variables\":{\"?city\":{\"query\":\"SELECT DISTINCT ?cityLabel where {?city wdt:P31/wdt:P279* wd:Q1637706. SERVICE wikibase:label { bd:serviceParam wikibase:language \\\"[AUTO_LANGUAGE],mul,en\\\"} }\"} } }
#defaultView:Map{\"hide\":[\"?comm1Label\",\"?coord1\", \"?comm2\",\"coord2\",\"?layer\",\"?str\",\"?line\", \"?rgb\"],\"layer\":\"?connectingLine1Label\"}
SELECT ?comm1 ?comm1Label ?coord1 ?comm2 ?coord2 ?line ?connectingLine1 ?connectingLine1Label ?layer ?rgb WHERE {
  BIND(wd:Q8686 AS ?city)
  ?comm1 wdt:P31/wdt:P279* wd:Q928830 ;
         wdt:P131*/wdt:P279* ?city;
         wdt:P625 ?coord1 ;
         wdt:P81 ?connectingLine1;
         wdt:P197 ?comm2 .
  ?connectingLine1 wdt:P465 ?rgb.
  ?comm2 wdt:P81 ?connectingLine2;
         wdt:P625 ?coord2 .
  FILTER (?connectingLine1 = ?connectingLine2)

  ?comm1 p:P625 [# ps:P625 [];
                  psv:P625 [ wikibase:geoLongitude ?coord1lon; wikibase:geoLatitude ?coord1lat; ] ] .
  ?comm2 p:P625 [# ps:P625 [];
                  psv:P625 [ wikibase:geoLongitude ?coord2lon; wikibase:geoLatitude ?coord2lat; ] ] .

  BIND(CONCAT('LINESTRING (', STR(?coord1lon), ' ', STR(?coord1lat), ',', STR(?coord2lon), ' ', STR(?coord2lat), ')') AS ?str) .
  BIND(STRDT(?str, geo:wktLiteral) AS ?line) .
  BIND(?connectingLine1 AS ?layer)

  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],mul,en\". }
}

ORDER BY (?connectingLine1Label)""" .
