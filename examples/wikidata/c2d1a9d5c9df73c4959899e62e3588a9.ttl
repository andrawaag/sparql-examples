@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema: <https://schema.org/> .

<https://www.wikidata.org/#query-c2d1a9d5c9df73c4959899e62e3588a9> a sh:SPARQLExecutable,
    sh:SPARQLSelectExecutable;
  rdfs:comment """See also Wikidata:WikiProject_Heritage_institutions/Tools_&_tasks#Sample_Queries Contents 1 How many collections are represented in the Sum of all Paintings dataset? 2 Self-portraits of women: Image grid 3 Art museums (global map) 4 How many Wikidata things have the \"in collection\" property 5 Collection sizes 6 Oldest institution in each country that now acts as a museum 7 Number of items in Wikidata with each collection property 8 Most common properties of objects in a given collection 9 Properties that items from two collections have in common 10 Refined version of above that just focuses on artists in common 11 Artists who died before the 19th century 12 Artists with no English Wikipedia article but an article in other languages 13 Paintings by Russian artists from around the time of the Russian Revolution 14 Landscape art that is taller than it is wide 15 Random selection of images from a collection 16 Items of type \"oil painting\" that don't include oil paint as a material 17 3D scan files of items from collections 18 Depictions in common between Ashmolean Museum and Cleveland Museum of Art 19 Cleveland Museum of Art items with no \"depicts\" property 20 Manuscripts 20.1 Image gallery of notable manuscripts (which have an image on Wikimedia Commons) 20.2 The most notable manuscripts and their collections 20.3 The most notable manuscripts available via IIIF, with IIIF links 20.4 Notable manuscripts and their collections (full query) 20.5 Collections of manuscripts 20.6 Manuscripts (and some other things) in the Matenadaran collection 20.7 Languages of manuscripts 20.8 Top ten languages by number of manuscripts 20.9 Materials used in manuscripts 20.10 Map of manuscript collections 20.11 Manuscripts lacking a collection 20.12 Objects with \"instance of papyrus\" (which shouldn't be the case) 20.13 Bodleian things and their online digitizations 20.14 Bodleian items with no image and no Commons category 20.15 Manuscripts of the Quran 20.16 Timeline of Shahnameh manuscripts 21 Ashmolean Museum 21.1 Things in the collection of the Ashmolean museum 21.2 Creators: comparison of Ashmolean items versus items in other GLAMs 21.3 People associated with Ashmolean items 21.4 Artists in the Ashmolean with entries in Benezit Dictionary of Artists 21.5 Getty Union List of Artist Names links for Ashmolean artists 21.6 Languages of Wikipedia articles about Ashmolean artists 21.7 Things depicted (but not places) 21.8 Locations associated with Ashmolean items 21.9 Ashmolean items associated with a given person or location 21.10 Ashmolean people associated with a given location or era 21.11 Locations associated with a given person 21.12 Ten nearest places to a place 21.13 Materials of things in the Ashmolean collection 21.14 Ashmolean items for a given material 21.15 Types of things in the Ashmolean collection 21.16 Items of a given type 21.17 Ashmolean items without a label 21.18 Ashmolean items without no inception date and no time period 21.19 Ashmolean things named \"Figure of \" but with no depiction property 21.20 Jameel items ordered by number of statements 21.21 Count of links from Jameel items to items that have a location 21.22 Wikipedia pages about Ashmolean items in languages other than English 21.23 web.ashmolean.org items without an Ashmolean Museum ID 21.24 Things in the Ashmolean that have gold as their only material 21.25 Things with two different Ashmolean Museum identifiers (should give no results) 21.26 External links from Ashmolean Museum's English Wikipedia article 21.27 Links to a particular domain from the Wikipedia biographies of artists in a given collection 21.28 Wikipedia articles about Ashmolean items, their links to the Ashmolean web site, and candidate links from Wikidata 21.29 External links from Commons File:pages 21.30 Connections from Ashmolean Museum items to Japan Search entities 22 Oxford Collections overview 22.1 Things connected to Oxford collection items 22.2 Things described at an Oxford web address but aren't in the collections that have shared with Wikidata 23 Pitt Rivers Museum 23.1 Unreferenced statements about things in the Pitt Rivers Museum 23.2 Things whose archives are in the Pitt-Rivers Museum 23.3 Image gallery of people whose archives are in the Pitt-Rivers Museum 24 Memory of the World Register 24.1 Language balance of Wikipedia articles about objects on the register 24.2 Wikipedia articles about objects on the register 25 Historic China 25.1 Things from dynasties of the imperial era, with their collections and shelfmarks 25.2 Timeline of states of Imperial period 26 Time periods 26.1 Historic periods and corresponding numbers of things in collections 27 History of Japan 27.1 Periods of Japanese history and what they were named after 27.2 Periods of Japanese history and calendar eras within them 28 Japan Search 28.1 Numbers of language labels for things with a Japan Search Name ID 29 Missing labels and descriptions 29.1 Paintings with no English description but a known artist label 29.2 Paintings with no English label but a Commons Category 29.3 Books with a title in a given language but not a label in that language 30 Wikidata maintenance 30.1 How many items have an inventory number but no collection? 30.2 How many items have an inventory number with a collection in a qualifier but no collection? 30.3 Collections and inventory numbers of items an inventory number with a collection in a qualifier but no collection 31 Semantic search 31.1 Synonyms 31.2 Names for types of coin 31.3 Things semantically related to a given topic 31.4 Data-driven semantic clustering 32 Astrolabes 32.1 All astrolabes (and parts), with collection and creator 32.2 Map of locations of Astrolabe origin 32.3 Timeline of Astrolabes 32.4 Creators with Reasonator links 32.5 Materials 32.6 Image gallery 32.7 Unreferenced statements about Oxford Astrolabes 32.8 Things called Astrolabe in English but with missing labels in other languages 32.9 English Wikipedia articles about creators of astrolabes that are in the Museum of the History of Science 32.10 Descriptions of things in the History of Science Museum 32.11 Astrolabes ordered by diameter 32.12 Scatter-plot of diameter against year of creation 32.13 Object with a given King number 33 IIIF 33.1 What kinds of thing have IIIF links in Wikidata? 33.2 What collections have IIIF links in Wikidata? 33.3 What artists have IIIF links in Wikidata? 33.4 Manuscripts with IIIF links (not just notable ones) 33.5 IIIF links for works by the artist Raphael 33.6 Image gallery of works by J. M. W. Turner with IIIF links 33.7 IIIF manifests for self-portrait paintings 34 Exhibition histories 34.1 What objects have appeared in the most exhibitions? 35 Art UK 35.1 Art UK artworks and things depicted in them How many collections are represented in the Sum of all Paintings dataset? [edit] SELECT (COUNT(DISTINCT ?coll) AS ?count) WHERE {
?obj wdt:P31/wdt:P279* wd:Q3305213. ?obj wdt:P195 ?coll FILTER (!CONTAINS(STR(?coll), \"well-known\"))
}
 Try it! Self-portraits of women: Image grid [edit] #defaultView:ImageGrid
SELECT ?p ?pLabel ?aLabel (SAMPLE(?image) AS ?img) (YEAR(?date) as ?year) WHERE {
?p wdt:P31 wd:Q3305213; wdt:P170 ?a; wdt:P136 wd:Q192110 ; wdt:P18 ?image. ?a wdt:P21 wd:Q6581072
OPTIONAL {?p wdt:P571 ?date}
SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
} GROUP BY ?p ?pLabel ?aLabel ?date 
ORDER BY ?year
 Try it! Art museums (global map) [edit] #defaultView:Map{\"hide\": \"?coords\"}
SELECT DISTINCT ?museum ?museumLabel (SAMPLE(?coords) AS ?coords) (SAMPLE(?image) AS ?image) ?url WHERE {
?museum wdt:P31 wd:Q207694 . ?museum wdt:P625 ?coords
OPTIONAL {?museum wdt:P18 ?image}
OPTIONAL {?museum wdt:P856 ?url}
SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\".
?museum rdfs:label ?museumLabel }
} GROUP BY ?museum ?museumLabel ?url
 Try it! How many Wikidata things have the \"in collection\" property [edit] The following query uses these:Properties: collection (P195)   , end time (P582)   SELECT (COUNT(?obj) AS ?count)  WHERE {
?obj p:P195 ?s.
?s ps:P195 ?collection.
MINUS { ?s pq:P582 [] }
} Try it! As of 25 November 2017: 314,221. An extra 1,150 if we allow relations that have an end date. As of 2 October 2017: 464,608. As of 29 August 2019: 1,092,686. Collection sizes [edit] The following query uses these:Items: Wikimedia list article (Q13406463)   Properties: part of (P361)   , instance of (P31)   , country (P17)   , collection or exhibition size (P1436)   , applies to part (P518)   SELECT ?collection ?collectionLabel ?partofLabel ?countryLabel ?size ?partLabel WHERE {
?collection p:P1436 ?s.
  ?s ps:P1436 ?size
  OPTIONAL {?s pq:P518 ?part}
  OPTIONAL {?collection wdt:P361 ?partof . # Get the organisation the collection is part of
            MINUS{ ?partof wdt:P31 wd:Q13406463 } } # but not Wikimedia list articles
  OPTIONAL {?collection wdt:P17 ?country}
SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\" }
  FILTER (?size > 100)
} ORDER BY DESC(?size) Try it! Oldest institution in each country that now acts as a museum [edit] SELECT DISTINCT ?countryLabel ?museum ?museumLabel (YEAR(?earliest) as ?year) WHERE {
{ SELECT ?country (MIN(?inception) as ?earliest) WHERE {
    ?museum wdt:P31/wdt:P279? wd:Q33506 ; wdt:P131?/wdt:P17 ?country; wdt:P571 ?inception
    } GROUP BY ?country }
?museum wdt:P31/wdt:P279? wd:Q33506 ; wdt:P131?/wdt:P17 ?country; wdt:P571 ?earliest.
MINUS {?country wdt:P576 []} # Exclude abolished countries like the Austrian Empire
SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
} ORDER BY ?countryLabel
 Try it! Number of items in Wikidata with each collection property [edit] The following query uses these:Properties: part of (P361)   , collection (P195)   , end time (P582)   SELECT (COUNT(?obj) AS ?count) ?collection ?collectionLabel ?partofLabel WHERE {
?obj p:P195 ?s.
?s ps:P195 ?collection.
MINUS { ?s pq:P582 [] }
OPTIONAL { ?collection wdt:P361 ?partof }
SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\" }
} GROUP BY ?collection ?collectionLabel ?partofLabel
ORDER BY DESC(?count)
LIMIT 100 Try it! Most common properties of objects in a given collection [edit] The following query uses these:Items: Tate (Q430682)   Properties: collection (P195)   , depicts (P180)   , creator (P170)   , time period (P2348)   , movement (P135)   , genre (P136)   , inspired by (P941)   , made from material (P186)   , location of creation (P1071)   SELECT (COUNT(?obj1) AS ?count) ?propertyLabel ?thingLabel ?thing WHERE {
?obj1 wdt:P195 wd:Q430682. #Tate
VALUES ?prop1 {wdt:P180 wdt:P170 wdt:P2348 wdt:P135 wdt:P136 wdt:P941 wdt:P186 wdt:P1071}
?obj1 ?prop1 ?thing.
?property ?ref ?prop1 ;
          rdf:type wikibase:Property .
SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\" }
} GROUP BY ?propertyLabel ?thingLabel ?thing ORDER BY DESC(?count) LIMIT 100 Try it! Properties that items from two collections have in common [edit] The following query uses these:Items: Tate (Q430682)   , Smithsonian American Art Museum (Q1192305)   Properties: collection (P195)   , depicts (P180)   , creator (P170)   , time period (P2348)   , movement (P135)   , genre (P136)   , inspired by (P941)   , made from material (P186)   , location of creation (P1071)   #defaultView:ScatterChart
SELECT (?count1 AS ?in_Tate) (?count2 AS ?in_Smithsonian) (CONCAT(?propertyLabel,\": \",?thingLabel)AS ?attribute) WHERE {
{ SELECT (COUNT(?obj1) AS ?count1) ?property ?thing WHERE {
 ?obj1 wdt:P195 wd:Q430682. #Tate
 VALUES ?prop1 {wdt:P180 wdt:P170 wdt:P2348 wdt:P135 wdt:P136 wdt:P941 wdt:P186 wdt:P1071}
 ?obj1 ?prop1 ?thing.
 ?property ?ref ?prop1 ; 
           rdf:type wikibase:Property .
  } GROUP BY ?property ?thing }
{ SELECT (COUNT(?obj2) AS ?count2) ?property ?thing WHERE {
 ?obj2 wdt:P195 wd:Q1192305. #Smithsonian
 VALUES ?prop1 {wdt:P180 wdt:P170 wdt:P2348 wdt:P135 wdt:P136 wdt:P941 wdt:P186 wdt:P1071}
 ?obj2 ?prop1 ?thing.
 ?property ?ref ?prop1 ;
           rdf:type wikibase:Property .
  } GROUP BY ?property ?thing }
 FILTER (?count2 >2 )
 FILTER (?count1 >2 )
SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". ?property rdfs:label ?propertyLabel .?thing rdfs:label ?thingLabel }
} Try it! Refined version of above that just focuses on artists in common [edit] The following query uses these:Items: Tate (Q430682)   , National Portrait Gallery (Q238587)   , anonymous (Q4233718)   Properties: collection (P195)   , creator (P170)   #defaultView:ScatterChart
SELECT (?count1 AS ?in_Tate) (?count2 AS ?in_NPG) ?artist WHERE {
{ SELECT (COUNT(?obj1) AS ?count1) ?creator WHERE {
 ?obj1 wdt:P195 wd:Q430682. #Tate
 ?obj1 wdt:P170 ?creator.
  } GROUP BY ?creator }
{ SELECT (COUNT(?obj2) AS ?count2) ?creator WHERE {
 ?obj2 wdt:P195 wd:Q238587. #National Portrait Gallery
 ?obj2 wdt:P170 ?creator.
  } GROUP BY ?creator }
 FILTER (?creator != wd:Q4233718) # exclude anonymous works
SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". ?creator rdfs:label ?artist }
} Try it! Artists who died before the 19th century [edit] SELECT DISTINCT ?artist ?artistLabel ?genderLabel ?countryLabel (year(?death) as ?deathyear) #?birthyear ?flyear 
WHERE {
  ?artist wdt:P31 wd:Q5 ; wdt:P106/wdt:P279? wd:Q1028181 .
?artist wdt:P570 ?death FILTER(year(?death)<1800).
OPTIONAL{?artist wdt:P21 ?gender}
OPTIONAL{?artist wdt:P27 ?country}
SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
} ORDER BY DESC(?deathyear)
 Try it! Artists with no English Wikipedia article but an article in other languages [edit] #title:People with a Benezit or Grove Art online link with sitelinks but no English Wikipedia article
SELECT DISTINCT ?artist ?artistLabel ?countryLabel ?links ?benezit_id ?grove_id WHERE {
{ ?artist wdt:P2843 ?benezit_id } UNION { ?artist wdt:P8406 ?grove_id }
  ?artist wikibase:sitelinks ?links FILTER (?links > 0).
  ?artist wdt:P31 wd:Q5.
  ?artist wdt:P27 ?country.
  FILTER NOT EXISTS{?enwp schema:about ?artist; schema:inLanguage \"en\"}
    SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
} ORDER BY DESC(?links)
 People with a Benezit or Grove Art online link with sitelinks but no English Wikipedia article Paintings by Russian artists from around the time of the Russian Revolution [edit] The following query uses these:Items: painting (Q3305213)   , Russian Empire (Q34266)   Properties: instance of (P31)   , creator (P170)   , country of citizenship (P27)   , image (P18)   , inception (P571)   #title:Paintings by Russian artists from around the time of the Russian Revolution
SELECT ?work ?workLabel ?artistLabel ?date ?datePrecision ?image WHERE {
  ?work wdt:P31 wd:Q3305213 # paintings
        ; wdt:P170 ?artist .
  ?artist wdt:P27 wd:Q34266. # artist's nationality: Russian Empire
  ?work p:P571/psv:P571 ?node .
  ?node wikibase:timeValue ?date ; # date of painting
   wikibase:timePrecision ?datePrecision # precision of date (e.g. day, month, year)
        BIND(YEAR(?date) as ?year) FILTER(?year > 1905) FILTER(?year < 1930) #specify date range
        FILTER (?datePrecision > 8) # known year
 .?work wdt:P18 ?image # only show art that Commons has an image for
    SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en,ru,et,de,fr\". }
} Paintings by Russian artists from around the time of the Russian Revolution This query as a Histropedia timeline Landscape art that is taller than it is wide [edit] #defaultView:ImageGrid
#title:Landscape art that is taller than it is wide
SELECT ?i ?iLabel ?iDescription (SAMPLE(?collLabel) AS ?collection) (SAMPLE(?img) AS ?image) WHERE {
?i wdt:P31 wd:Q3305213.
  ?i wdt:P136 wd:Q191163 .
     ?i wdt:P2048 ?height.
     ?i wdt:P2049 ?width.
    FILTER (?height > ?width)
  ?i wdt:P18 ?img.
  ?i wdt:P195 ?coll.
SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\".
                        ?coll rdfs:label ?collLabel . ?i rdfs:label ?iLabel .
                       ?i schema:description ?iDescription }
} GROUP BY ?i ?iLabel ?iDescription
 Landscape art that is taller than it is wide Random selection of images from a collection [edit] In theory, results should change each day. #defaultView:ImageGrid
SELECT ?item ?itemLabel (SAMPLE(?img) AS ?image) WHERE {
  ?item wdt:P195 wd:Q109893034 .
  ?item wdt:P18 ?img
    SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
  BIND(SHA512(CONCAT(STR(RAND()), STR(NOW()), STR(?item))) AS ?random)
} GROUP BY ?item ?itemLabel
ORDER BY ?random
LIMIT 20
 Try it! Items of type \"oil painting\" that don't include oil paint as a material [edit] SELECT ?item ?itemLabel ?itemDescription ?collectionLabel WHERE {
?item wdt:P31 wd:Q56676227
      MINUS {?item wdt:P186 wd:Q296955}
OPTIONAL {?item wdt:P195 ?collection}
SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
}
 Try it! 3D scan files of items from collections [edit] SELECT ?item ?itemLabel ?itemDescription ?model WHERE {
?item wdt:P4896 ?model; wdt:P195 [].
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en,fr\" }
} ORDER BY ?itemLabel
 Try it! Depictions in common between Ashmolean Museum and Cleveland Museum of Art [edit] SELECT ?depicted ?depictedLabel ?ashcount ?ashexample ?ashexampleLabel ?clevcount ?clevexample ?clevexampleLabel WHERE {
{SELECT ?depicted (Sample(?itemash) AS ?ashexample) (COUNT(DISTINCT ?itemash) AS ?ashcount) (sample(?itemclev) as ?clevexample) (COUNT(DISTINCT ?itemclev) AS ?clevcount) WHERE {
?itemclev wdt:P195 wd:Q657415; wdt:P180 ?depicted.
?itemash wdt:P195 wd:Q636400 ; wdt:P180 ?depicted.
  } GROUP BY ?depicted }
SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
} ORDER BY DESC(?ashcount + ?clevcount)
 Try it! Cleveland Museum of Art items with no \"depicts\" property [edit] #defaultView:ImageGrid
SELECT DISTINCT ?item ?itemLabel ?id ?img WHERE {
  ?item p:P217 [ps:P217 ?id; pq:P195 wd:Q657415] .
  ?item wdt:P5008 wd:Q60729883 .
  OPTIONAL { ?item wdt:P18 ?img } .
  MINUS { ?item wdt:P180 [] }
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
}
 Try it! Manuscripts [edit] Image gallery of notable manuscripts (which have an image on Wikimedia Commons) [edit] The following query uses these:Items: manuscript (Q87167)   , Dead Sea scrolls (Q145780)   Properties: instance of (P31)   , subclass of (P279)   , image (P18)    Features: ImageGrid (Q24515278)  """@en;
  dcterms:isPartOf <https://www.wikidata.org//wiki/User:MartinPoulter/queries/collections>;
  dcterms:license <https://creativecommons.org/licenses/by-sa/4.0/>;
  sh:prefixes _:genid-4e694113159d4e3db4a1a913894a81d834952-wikidata_prefixes;
  schema:target <https://query.wikidata.org/sparql/>;
  sh:select """PREFIX wikibase: <http://wikiba.se/ontology#>
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX wd: <http://www.wikidata.org/entity/>
PREFIX schema: <http://schema.org/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX bd: <http://www.bigdata.com/rdf#>
#defaultView:ImageGrid
SELECT ?link (MIN(?image) AS ?img) ?qLabel (COUNT(DISTINCT ?sitelink) AS ?linkcount) WHERE {
  ?q (wdt:P31/wdt:P279*) wd:Q87167.
  FILTER (?q != wd:Q145780) # Exclude Dead Sea Scrolls: too broad
  ?sitelink schema:about ?q.
  ?q wdt:P18 ?image.
  BIND(URI(CONCAT(\"http://example.org/test/manuscripts/index.php?q=manuscript/\",SUBSTR(STR(?q),32))) AS ?link)
  SERVICE wikibase:label {
    bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\".
    ?q rdfs:label ?qLabel.
  }
}
GROUP BY ?link ?qLabel
ORDER BY DESC(?linkcount)
LIMIT 100""" .
