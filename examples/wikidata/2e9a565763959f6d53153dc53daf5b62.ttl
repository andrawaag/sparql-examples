@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema: <https://schema.org/> .

<https://www.wikidata.org/#query-2e9a565763959f6d53153dc53daf5b62> a sh:SPARQLExecutable,
    sh:SPARQLSelectExecutable;
  dcterms:isPartOf <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/lb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/th>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/eu>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/en-gb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/vec>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/hy>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/id>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/be-tarask>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/tr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ro>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/he>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/zh>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/pt-br>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/si>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/eo>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/da>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ar>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ko>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/pl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ms>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/sv>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/lt>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/nl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ca>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/uk>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/it>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ja>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/es>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/cs>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ru>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/de>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/fr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/en>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples>;
  dcterms:license <https://creativecommons.org/licenses/by-sa/4.0/>;
  sh:prefixes _:genid-4e694113159d4e3db4a1a913894a81d818467-wikidata_prefixes, _:genid-4e694113159d4e3db4a1a913894a81d818467-6451690CEF368BF101763D6F77C0EE22,
    _:genid-4e694113159d4e3db4a1a913894a81d818467-92A9D57DA22DE8F1A65EB0F3037B4431, _:genid-4e694113159d4e3db4a1a913894a81d818467-C9D3C16B2EC9AE35B203A6F7AFFBA20A,
    _:genid-4e694113159d4e3db4a1a913894a81d818467-EEE87D959FDB86591D530AD683F4D630, _:genid-4e694113159d4e3db4a1a913894a81d818467-4D032EA4C57045634FA15A5ACF725F0D,
    _:genid-4e694113159d4e3db4a1a913894a81d818467-14C1B4295017C22E1C03D9305D9A8418, _:genid-4e694113159d4e3db4a1a913894a81d818467-F4E44C02171961C0C712027CFC8DD42F,
    _:genid-4e694113159d4e3db4a1a913894a81d818467-105FE5E70DE297F287540004527F00F0, _:genid-4e694113159d4e3db4a1a913894a81d818467-B260308B9306AF7CFEE242C6D0BAC481,
    _:genid-4e694113159d4e3db4a1a913894a81d818467-0FA0C2D3309279CE70E7FE8A63156A2A, _:genid-4e694113159d4e3db4a1a913894a81d818467-FC0F72D79ACE6934DFDED3359817D849,
    _:genid-4e694113159d4e3db4a1a913894a81d818467-09DA49A8CE6457D477409988C1332DB3, _:genid-4e694113159d4e3db4a1a913894a81d818467-740EB7D2EE226A095800B6160B65E9B1,
    _:genid-4e694113159d4e3db4a1a913894a81d818467-5099E0C8D2E467435108FAC50AE97CE7, _:genid-4e694113159d4e3db4a1a913894a81d818467-F123F551D1111739351DEB5A573227E2,
    _:genid-4e694113159d4e3db4a1a913894a81d818467-D372D9AE25677522221C12A16F231CAD, _:genid-4e694113159d4e3db4a1a913894a81d818467-FBBCF11D22D1029ED4D6C5EDF60ED296,
    _:genid-4e694113159d4e3db4a1a913894a81d818467-E6A10F96682957360C1346CB12FF11D6, _:genid-4e694113159d4e3db4a1a913894a81d818467-E3830D2133E6B7378BF287A2CCBF9F62,
    _:genid-4e694113159d4e3db4a1a913894a81d818467-D5C342AAC70191B52FA3D3AF3304D9B7, _:genid-4e694113159d4e3db4a1a913894a81d818467-9A5DE80E4D2A580E1A7042498E86960A,
    _:genid-4e694113159d4e3db4a1a913894a81d818467-588B38FFEC0DAC91802E52984D1EF6FE, _:genid-4e694113159d4e3db4a1a913894a81d818467-9199042777C87F8CD1859F06387F8CB2,
    _:genid-4e694113159d4e3db4a1a913894a81d818467-0E3A193C09CE115DB7C1F283A4EE8C67, _:genid-4e694113159d4e3db4a1a913894a81d818467-AA8D5F3D0559DAFD788F8AC12C26BBE0,
    _:genid-4e694113159d4e3db4a1a913894a81d818467-229E6A9312B1E4F0BC97FADAC13CEF83, _:genid-4e694113159d4e3db4a1a913894a81d818467-D117AE5E09CA2FBF5EDD6924530BAD22,
    _:genid-4e694113159d4e3db4a1a913894a81d818467-43CFF0FF0E091DF202A79A318AFA29CB, _:genid-4e694113159d4e3db4a1a913894a81d818467-988157F57421BCD6576882B307E26255,
    _:genid-4e694113159d4e3db4a1a913894a81d818467-E3F6FE4EAA8CD1437F0A495B5F24E3AB, _:genid-4e694113159d4e3db4a1a913894a81d818467-43DBFC24DCF92ECC7F5BC166AB55712A,
    _:genid-4e694113159d4e3db4a1a913894a81d818467-2D8D60CD3AE9FE79FEEDA8AEED31AF51, _:genid-4e694113159d4e3db4a1a913894a81d818467-20E133861E3C31B864329B0F1F3050A3;
  schema:target <https://query.wikidata.org/sparql/>;
  sh:select """PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX wd: <http://www.wikidata.org/entity/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX geo: <http://www.opengis.net/ont/geosparql#>
#defaultView:Map{\"hide\":[\"?atm\",\"?geometry\"], \"layer\": \"?bankLabel\"}

PREFIX lgdo: <http://linkedgeodata.org/ontology/>
PREFIX geom: <http://geovocab.org/geometry#>
PREFIX bif: <bif:>

SELECT ?atm ?geometry ?bank ?bankLabel WHERE {
  hint:Query hint:optimizer \"None\".

  SERVICE <http://linkedgeodata.org/sparql> {
    { ?atm a lgdo:Bank; lgdo:atm true. }
    UNION { ?atm a lgdo:Atm. }

    ?atm geom:geometry [geo:asWKT ?geometry];
         lgdo:operator ?operator.
    FILTER(bif:st_intersects(?geometry, bif:st_point(11.5746898, 48.1479876), 5)) # 5 km around Munich
  }

  BIND(STRLANG(?operator, \"de\") as ?bankLabel)
  ?bank rdfs:label ?bankLabel.

  # bank is part of the Bankcard service network, either via an explicit statement or implicitly due to its legal form (unless explicitly excluded)
  { ?bank wdt:P527 wd:Q806724. }
  UNION { ?bank wdt:P1454 wd:Q5349747. }
  MINUS { wd:Q806724 wdt:P3113 ?bank. }
}""" .
