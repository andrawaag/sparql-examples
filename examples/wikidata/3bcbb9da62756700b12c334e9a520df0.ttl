@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema: <https://schema.org/> .

<https://www.wikidata.org/#query-3bcbb9da62756700b12c334e9a520df0> a sh:SPARQLExecutable,
    sh:SPARQLSelectExecutable;
  dcterms:isPartOf <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial>, <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/lb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/he>, <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/nl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/szl>, <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/en-gb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/zh>, <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/hy>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/tr>, <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/da>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/ar>, <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/ja>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/ca>, <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/sv>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/ru>, <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/uk>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/pl>, <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/en>;
  dcterms:license <https://creativecommons.org/licenses/by-sa/4.0/>;
  sh:prefixes _:genid-4e694113159d4e3db4a1a913894a81d828628-wikidata_prefixes, _:genid-4e694113159d4e3db4a1a913894a81d828628-FC7A8C87EE06AEC58A6670B024BD22DA,
    _:genid-4e694113159d4e3db4a1a913894a81d828628-1914BB8B94FBE4986812EA98A9663C2E, _:genid-4e694113159d4e3db4a1a913894a81d828628-E9E77243C6AA42984B30670206FCF9FE,
    _:genid-4e694113159d4e3db4a1a913894a81d828628-821B0533458F5016F90F3593782838C0, _:genid-4e694113159d4e3db4a1a913894a81d828628-AF6C700F2D46B49CCA1BE4D8FAD7EABA,
    _:genid-4e694113159d4e3db4a1a913894a81d828628-C25DC906D2AC18D4B20995348C7E5D46, _:genid-4e694113159d4e3db4a1a913894a81d828628-5EA9CF45459C34655F7458C8A405934E,
    _:genid-4e694113159d4e3db4a1a913894a81d828628-52D43349023E0FC373679229F08477A1, _:genid-4e694113159d4e3db4a1a913894a81d828628-5760ED063018032C32F99EEE67E908BC,
    _:genid-4e694113159d4e3db4a1a913894a81d828628-68359C4574FD90B46F3DE2E400A6A0D0, _:genid-4e694113159d4e3db4a1a913894a81d828628-1ABF1B7B30F391D4600B5383FE2F0371,
    _:genid-4e694113159d4e3db4a1a913894a81d828628-AF11680E4ECBE91F01ED103D0D7ACE4F, _:genid-4e694113159d4e3db4a1a913894a81d828628-F0BAC626C98FFB8A39E01DBE714B4EF6,
    _:genid-4e694113159d4e3db4a1a913894a81d828628-98075CF0243A6E9A39B82414B7E73F87, _:genid-4e694113159d4e3db4a1a913894a81d828628-B41015485F30EEB5F333C7FB89DB198B,
    _:genid-4e694113159d4e3db4a1a913894a81d828628-80DC59B6FBF32428A4562B3902A4BAD8, _:genid-4e694113159d4e3db4a1a913894a81d828628-56ED749655F8E005C2F801346350A358,
    _:genid-4e694113159d4e3db4a1a913894a81d828628-F99C8025B1FA7B4884CE805ED5FA8D17;
  schema:target <https://query.wikidata.org/sparql/>;
  sh:select """PREFIX wikibase: <http://wikiba.se/ontology#>
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX bd: <http://www.bigdata.com/rdf#>
SELECT ?publisher ?publisherLabel (AVG(?pages) AS ?avgPages)
WHERE
{
  ?book wdt:P123 ?publisher;
        wdt:P1104 ?pages.
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE]\". }
}
GROUP BY ?publisher ?publisherLabel
ORDER BY DESC(?avgPages)""" .
