@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema: <https://schema.org/> .

<https://www.wikidata.org/#query-772326fb31df09c9b50b93dc47e08c1a> a sh:SPARQLExecutable,
    sh:SPARQLSelectExecutable;
  sh:select """SELECT 
	?fam ?famLabel ?instanceof ?instanceofLabel 
	(SAMPLE(?image) as ?image)  (SAMPLE(?taxonname) as ?taxonname)
	# (GROUP_CONCAT(DISTINCT ?species; separator=\"/\" ) as ?allspecies)
	(GROUP_CONCAT(DISTINCT ?extinct; separator=\", \" ) as ?extinct_species)
	(GROUP_CONCAT(DISTINCT ?nonextinct; separator=\", \" ) as ?nonextinct_species)
	(GROUP_CONCAT(DISTINCT ?unknown; separator=\", \" ) as ?unknownstatus_species)
	(GROUP_CONCAT(DISTINCT ?taxonnamespeciesmissing; separator=\" \" ) as ?taxonname_species_missing)
WHERE
{
  	?item wdt:P171* wd:Q5113 .
	?item wdt:P105 wd:Q7432 .
  	?item wdt:P171* ?fam .
  	?fam wdt:P105 wd:Q35409 .
  	?fam wdt:P31 ?instanceof . 
  
  	# FILTER NOT EXISTS { ?fam wdt:P31 wd:Q23038290 }    # fossil taxon (family)
  	# FILTER NOT EXISTS { ?item wdt:P31 wd:Q23038290 }   # fossil taxon (species)
  	# FILTER NOT EXISTS { ?item wdt:P141 wd:Q237350 }
  
	OPTIONAL { ?fam wdt:P18 ?image } .
  	OPTIONAL { ?fam wdt:P225 ?taxonname } .

  	OPTIONAL { ?item wdt:P225 ?taxonnamespecies } .  
  	BIND( IF(!BOUND(?taxonnamespecies), str(?item), \"\") as ?taxonnamespeciesmissing) # does this work?

  	OPTIONAL { ?item wdt:P141 ?status }
	BIND(IF(!BOUND(?status), ?taxonnamespecies, \"\") as ?unknown)  
	BIND(IF(?status = wd:Q237350, ?taxonnamespecies, \"\") as ?extinct)  
	BIND(IF(?status != wd:Q237350, ?taxonnamespecies, \"\") as ?nonextinct) 
   	SERVICE wikibase:label { bd:serviceParam wikibase:language \"en\" . }
}
GROUP BY ?fam ?famLabel ?instanceof ?instanceofLabel""";
  rdfs:comment """ This page is an archive. Please do not modify it. Use the current page, even to continue an old discussion. Contents 1 Data from wikispecies 2 wdtaxonomy 3 Itame pustularia (Q7576349) 4 Dogs 5 Cigaritis syama (Q21247298) <-> Spindasis syama (Q1595122) 6 Conflicts and discrepancies for resolution 6.1 More 6.2 Another 6.3 review needed 7 Non extinct bird families 8 Baltimore classification property proposal 9 Wikispecies 10 Cats Data from wikispecies I'm copying a question I posed in Wikispecies here at the suggestion of Andy Mabbett. Over the past few months, I have been trying to sort out Fungi on wikispecies since it was very outdated. I understand the view point that eventually data should be updated directly into Wikidata and then pulled to wikispecies, but I was hoping (perhaps naively) that when wikidata was first populated it would use information from wikispecies as the authority for taxonomy. This does not seem to be the case. For example, I cleaned up the Tremellomycetes back in November, members from this class like Kwoniella were added to wikidata last week using the old outdated information that appears to be from wikipedia. Is there a way to ensure that wikidata is getting the best information it can from the beginning? Voganaa (talk) 16:05, 27 February 2017 (UTC) There is some taxonomy being added to Wikidata, but proportionally it is very little. Most of what is being added here is imported from another Wikimedia project. What Wikidata is good at, is importing ID's from databases. We are doing well to just weed out some of the really bogus stuff. But what is imported from Wikispecies is not necessarily good. For example there are loads of cases where there are two Wikispecies pages for one name (once even three pages for one name). - Brya (talk) 18:05, 27 February 2017 (UTC) Would it be feasible to have users vouch for certain groups/taxa? I took a quick look at some of what wikidata is importing for fungi and it's pretty rough. Not just out of date but also basic errors like calling phyla divisions in Fungi. There are also a few areas where wikispecies is better than anything else currently available in other databases.Voganaa (talk) 20:12, 27 February 2017 (UTC) The way to improve Wikidata is to add more good quality references for taxonomic decisions (\"A is a synonym of B according to C\"). Nothing properly referenced goes out of date. - Brya (talk) 05:58, 28 February 2017 (UTC) Sure, but add in what way? Directly into wikidata manually? I was under the impression that the project was trying to automate collection of good data at this point. I understand if at this stage in the project, wikidata has other things to worry about. In that case wouldn't it be better not to include any parent and child taxon information as opposed to annotating taxa with the wrong information, as is currently happening? Just create the taxa, import their ID's from other databases and leave it at that? In the mean time would it be productive to clean up wikispecies so that this information could be imported en masse from there when the time comes?Voganaa (talk) 08:20, 28 February 2017 (UTC) It seems to me that it should be possible to import all references from Wikispecies by bot. How they apply to taxa is probably something to be done by hand. And do remember the intent is not to produce \"right names\" for taxa. - Brya (talk) 11:37, 28 February 2017 (UTC) PS. By definition, for fungi, the term \"phylum\" is equivalent to the term \"division\"; these terms are interchangeable. Nothing wrong there. Writing \"fungi\" with an initial capital letter would count as an error, today. - Brya (talk) 12:02, 28 February 2017 (UTC) I doubt importing references from wikispecies is a good idea as a whole. Ideally, the references for a taxa should be the original publication where it was described. Other databases have this information, but wikispecies often references any material that has used the name. How they apply to taxa is what I'm suggesting can be automated through the use of wikispecies (or at least a cleaned up wikispecies). I'm not clear by what you mean as \"right name\". If you mean synonymy then I don't see why wikidata wouldn't want to incorporate this information. While phylum and divisio refer to the same rank, they are not equivalent terms. If a taxa is described with the term phylum, it should be called a phylum, if it is described with the term divisio then a division. Unless I've missed something major, it is correct to refer to the kingdom as Fungi, but the organism as fungi. I was trying to be clear that I was referring to the kingdom. Voganaa (talk) 14:54, 28 February 2017 (UTC) In case of Tremellomycetes (Q133144) you are probably refering to the paper Towards an integrated phylogenetic classification of the Tremellomycetes (Q28550549) where the parent of Kwoniella (Q6450559) is \"set\" Cryptococcaceae (Q27685061). You can update the wikidata item this way. --Succu (talk) 15:23, 28 February 2017 (UTC) @Succu:, yes this is exactly what I was referring to. The point is I've already updated all of this information in wikispecies. Since it exists there in the correct form, when data is being input to wikidata, it would be nice if it were possible take it from there so that someone doesn't have to go through and manually correct the errors. If it is not currently possible to pull the data right from wikispecies then my personal opinion is that no data on taxonomy should be included in the taxa page on wikidata rather than outdated/incorrect data. Voganaa (talk) 16:07, 28 February 2017 (UTC) Sorry, but Wikispecies is, like other wikimedia projects, not a source at all. The integration of Wikispecies information (mainly the sitelinks) started in October 2015. We are dealing with taxonomic and nomenclatural issues here much longer. Adding a Wikispecies sitelink to Wikidata is nothing more than adding a sitelink. Just to put thing somehow together. --Succu (talk) 16:17, 28 February 2017 (UTC) I understand that wikispecies itself is not a primary source, but a source is needed to get the information into wikidata. Whatever source is being used now is outdated. Is wikidata intending to go through all of the original publications and grab the info that way? I don't understand why it wouldn't make sense to use the information on wikispecies (not links to it) rather than using whatever source is being used now. Voganaa (talk) 16:39, 28 February 2017 (UTC) Wikidata does not present \"right\" names or a \"right\" taxonomy: Wikidata aims to gather data, such as taxonomic viewpoints. As sources for such taxonomic viewpoints we need taxonomic books or papers (Succu's example shows how these are added). Original publications are moderately interesting as references. Preferably, these are (or are accompanied by) links to BHL (or the equivalent), to show original spelling. What Wikidata really needs are references to the main taxonomic viewpoints. If there are three competing taxonomic viewpoints, these should each be represented in Wikidata, with a good quality reference. And as each reference needs to have its own item, it may be a good idea to import these from Wikispecies. By definition, for fungi, the term \"phylum\" is equivalent to the term \"division\"; one or the other may be less appropriate in a certain context, but speaking generally, they are both correct. The fungi are not a natural unit, so they are no longer a taxon. The word indicates a general english name. The organism is a fungus. - Brya (talk) 17:56, 28 February 2017 (UTC) Even if I would presume that a bot is able to parse and map a reference at Wikispecies to a reference at Wikidata (or create a correct new one) - which is hard enough - how should that bot realise this reference reflects a newer (or alternative) taxonomic viewpoint? If want to have it here, Voganaa, the easiest way ist to add the new viewpoint by hand or create a bot readable file like this (Apocynaceae) or this (Sciuridae). --Succu (talk) 19:58, 28 February 2017 (UTC) The bot readable files look like a great solution. Should new ones be created under your userpage or my own? Am I correct in understanding that the format is Rank/Name/Author/Reference? Is reference needed here? Or can the bot mine it from a place like Mycobank as it is doing for IDs? You should use your user space. The bot is configurable. So you need only to provide the colums you need. Generally I can read the information provided MycoBank and Index Fungorum. But as I stated before: I's not trivial to make them usable here. BTW: In the next time I will make use of The 2016 classification of lichenized fungi in the Ascomycota and Basidiomycota – Approaching one thousand genera (Q28858882) to add some more references. --Succu (talk) 16:54, 1 March 2017 (UTC) PS: See User:Succu/Lichenized fungi. --Succu (talk) 18:40, 3 March 2017 (UTC) @Brya:, fungi comprise a single monophyletic group, how is this not a \"natural unit\". Fungi is certainly still a taxon, what is your source for claiming it's not? Voganaa (talk) 08:39, 1 March 2017 (UTC) The word \"Fungi\" has been dropped from the 'botanical' Code as the name of a taxon over twenty-five years ago. Some fungal lines are treated as animals (that is, under the zoological Code); what does, and what does not, belong to fungi keeps shifting all the time. - Brya (talk) 11:51, 1 March 2017 (UTC) This is flatly untrue. We know exactly what fungi are, none of them are treated under the zoological code. Now that we know microsporidia (and relatives) are fungi allowances were made so that taxa which were properly defined under the zoological code, but are now known to be fungi can be retained. If for example you were to describe a new microsporidian taxon after 2011 you would have to follow the ICN. Similar allowances were made along time ago for algae. Voganaa (talk) 15:26, 1 March 2017 (UTC) That is flatly untrue. - Brya (talk) 17:36, 1 March 2017 (UTC) @Voganaa: seriously??? I am an editor at Wikispecies, have been for 10 years and am also a professional taxonomist. I always use the original references as they are the only valid source for the original usage of a name. What people do with it later is anyone's guess and often subject to interpretation. The fungi are not treated by the zoological code, why should they be, there are 5 codes of nomenclature and the fungi has one of them. Now I can concede that the fungi in particular may be out of date on wikispecies. It is hard to maintain the groups that have less active workers. If you want to update it update it. The best way that wikispecies can work together with wikidata is for Wikispecies to be a virtual front end, since it tends to attract taxonomic specialists, Wikidata is a database, the meaning of the data is secondary to its existence in databases. Wikidata should import data from wikispecies not create it, but then it should be down the line used by the wikipedias. That would be the ideal. Cheers Scott Thomson (Faendalimas) talk 22:58, 4 March 2017 (UTC) wdtaxonomy I created a command line tool to extract general classification schemes (classification scheme (Q5962346)) from Wikidata. Since version 0.3.1, released two days ago, it also supports querying by a different hierarchical property than subclass of (P279), for instance parent taxon (P171). I tried with a few examples of biological taxonomies:taxonomy of Canis (Q149892): $ wdtaxonomy -P P171 Q149892 parent taxon hierarchy of Canis (Q149892): wdtaxonomy -P P171 --reverse Q26972265 direct suborders of Carnivora (Q25306) with total number of taxons below: wdtaxonomy -P P171/P171 --children --total Q25306 direct suborders of Carnivora (Q25306) with total number of individuals (instance of (P31)): wdtaxonomy -P P171/P31 --children --total Q25306 Feedback (bug reports, feature requests, examples...) is welcome! -- JakobVoss (talk) 11:39, 6 March 2017 (UTC) This does not pay attention to selecting one particular taxonomy, that is, according to a single reference? - Brya (talk) 17:39, 6 March 2017 (UTC) Itame pustularia (Q7576349) Can someone look at Itame pustularia (Q7576349), the synonym of Speranza pustularia (Q28817373) (Guenée, 1957). LepIndex ID seems to suggest that it is a synonym of Itame latiferrugata (Q13372309) Walker, 1862. Am I misreading LepIndex ID. That seems wrong since nobody suggests that Speranza pustularia (Q28817373) and Itame latiferrugata (Q13372309) are synonyms--Jarekt (talk) 20:37, 1 March 2017 (UTC) I guess it reads that way, but it is hard to be sure, with the handwritten cards. Anyway, Lepindex is not authoritative. - Brya (talk) 05:07, 2 March 2017 (UTC) Thanks just making sure I am not missing something. --Jarekt (talk) 02:36, 16 March 2017 (UTC) Dogs Is there any reason that en:Dog isn't linked to from Canis lupus familiaris (Q26972265)? I was going to add it, but not sure if there is some reason that the wikipedia link to this (and presumably all the other language articles about dogs) isn't linked. HYanWong (talk) 17:25, 5 March 2017 (UTC) Yes, it is one of those dubious cases of a very prominent animal, where it seems to work better to have an item for the (fuzzy) general concept, and separate items for the most prominent scientific names. - Brya (talk) 18:01, 5 March 2017 (UTC) @Brya: there are many very prominent domesticated and agricultural animals and plants that bear no similarity to their wild counterparts. With dogs many domestic dog breeds are hybrids anyway. My own view is to keep these things separate. But am not sure of the best way in the long run, ie how popular is popular so to speak?? Not disagreeing with you just maybe a point for discussion. Scott Thomson (Faendalimas) talk 21:43, 5 March 2017 (UTC) This is not clear-cut. For many plants it is the fruit, or other product, which is prominent in the public eye. In those cases, it is the fruit, or other product, which has its own item. - Brya (talk) 05:14, 6 March 2017 (UTC) @Brya: I'm trying to take popular taxa (including Canis lupus familiaris) from e.g. NCBI and map them using the NCBI identifiers to wipikedia pages in different languages. Since there isn't a link from Canis lupus familiaris (Q26972265) to the 'Dog' entry, do you have any suggestions about how I might be able to use wikidata to go from NCBI identifier 9615 to en:Dog? Thanks if you can provide any hints. HYanWong (talk) 21:17, 11 March 2017 (UTC) NB, I looked at using the 'use' field, as the item for Canis lupus familiaris sets use as dog, but then Achillea millefolium sets use as food! so I'm not sure if this is the right way to do it? HYanWong (talk) 21:59, 11 March 2017 (UTC) The best way in such cases would be by \"common name of\". And \"use as\" \"food\" for Achillea millefolium is a very narrow selection. - Brya (talk) 07:16, 12 March 2017 (UTC) @Brya: Great, thanks. This query shows the 42 taxa that are an instance of common name with the common name pointing to something (usually a taxon). I think there are some items in that list that could probably be pruned, e.g. Q17999152. Also, there seem to be 2 uses of 'common name of', firstly when the name is a vernacular that applies to many different species (e.g. Q2925879), and secondly, where it applies to a single taxon but the concept is a more general than the biological delineation (e.g. dog Q144). I wonder if there is any way to distinguish between these? Is there perhaps an argument to introduce an explicit new property, placed on a select few taxa, like dogs, that points to the \"main\" dog page, which has the wikipedia links - something like 'use' but which has a more specific, taxonomic focus? HYanWong (talk) 16:44, 13 March 2017 (UTC) Thank you. I am afraid that at this stage there is a limited number of usages, and they are all somewhat idiosyncratic cases. Maybe by the time that we have more cases, it will be more clear, or it will be worthwhile to have a more sophisticated structure (or property). - Brya (talk) 18:05, 13 March 2017 (UTC) Cigaritis syama (Q21247298) <-> Spindasis syama (Q1595122) Two species that need interwikis merged left or right, though no idea which is the preferred. — billinghurst sDrewth 11:45, 6 March 2017 (UTC) According to English Wikipedia and Wikispecies Cigaritis syama (Q21247298) is the preferred name, but a reference would be nice. Otherwise I think I cleaned it up. --Jarekt (talk) 02:33, 16 March 2017 (UTC) Conflicts and discrepancies for resolution I am doing (simpler) merges and going to note those that need resolution with some more expert knowledge to resolve. — billinghurst sDrewth 10:22, 19 January 2017 (UTC) Ophrys fuciflora (Q15432423) and Ophrys holosericea (Q161487) Pleiogynium timoriense (Q15546020) and Pleiogynium timoriense (Q3027862) Quercus fabri (Q15337732) and Quercus fabri (Q15232490) The first set concerns two different names: do not merge, just move sitelinks. The second set is tricky: these are spelling variations of the same name. It needs expert judgement. In this case the basionym is spelled with the extra -i- so this should be maintained, although the form without probably is better Latin. So merge, with \"taxon name\" = \"Pleiogynium timoriense\". - Brya (talk) 11:48, 19 January 2017 (UTC) The third set, again, are spelling variations of the same name. This is a headache, but best merged with \"taxon name\" = \"Quercus fabri\", which is the original and accepted form. - Brya (talk) 11:51, 19 January 2017 (UTC) More Acalypha australis (Q10855934) and Acalypha australis (Q6676255) Syrmatium glabrum (Q15542450) and Lotus scoparius (Q3024330) and Acmispon glaber (Q15490404) sources differ on which is authoritative synonym (between 1 and 2) Agave de-meesteriana (Q16748108) and Agave de-meesteriana (Q15488132) conflicting authoritative sources Callistege mi (Q17295088) and Euclidia mi (Q579690) different sources reverse base names Cascabela thevetia (Q10694475) and Thevetia peruviana (Q312147) — billinghurst sDrewth 15:44, 21 January 2017 (UTC) the Callistege case is a matter of confusion whether Callistege is a genus or a subgenus. - Brya (talk) 17:31, 21 January 2017 (UTC) Agave de(-)meesteriana: Accepted as Agave de-meesteriana by WCSPF, but probably a nomen nudum [1] and later named Agave desmettiana (Q15488628)... --Succu (talk) 19:07, 21 January 2017 (UTC) Closterotomus norwegicus (Q233021) and Calocoris norwegicus (Q5023130) and a third variation that we don't mention \"Closterotomus norvegicus\" Cigaritis syama (Q21247298) and Spindasis syama (Q1595122) sources undecided In general, there is no such thing as The Authoritative Synonym. - Brya (talk) 06:03, 22 January 2017 (UTC) Sure, however, are we aiming for interwikis to the preferred/most authoritative? Or do we not mind that they are shared through the various synonyms. That information is lacking on the explanation on obverse to this page. I am just poking those that are non-simple for a more informed head to review. If you do not want them flagged for review, then please just say so. — billinghurst sDrewth 06:30, 22 January 2017 (UTC) Sitelinks dealing with homotypic names (different names to the same anchoring point), like Closterotomus norwegicus and Calocoris norwegicus, should be in the same item, so as to connect the Wikipedia pages. - Brya (talk) 12:42, 22 January 2017 (UTC) Another Spergula rubra (Q15554133) and Spergularia rubra (Q1474695) Done review needed Q15244621 (commons:Artocarpus lakoocha) and Q759430 (es:Artocarpus lakoocha) The ID links both claim that one is the synonym of the other. Yes, looks complicated. - Brya (talk) 18:02, 16 March 2017 (UTC) Q143772 (commons:Androlepis skinneri) and Q15301721 One of the genus with a single species. Looks confused. Looks OK? - Brya (talk) 18:02, 16 March 2017 (UTC) Q15391908 (commons:Garcinia brasiliensis) and Q2391176 Another mishmash There is indeed confusion ([2]). - Brya (talk) 06:01, 17 March 2017 (UTC) Q17132461 (commons:Kadenia dubia) and Q459324 ceb, sv, war each have a (bot-made) page on both names (not all that uncommon). - Brya (talk) 06:19, 17 March 2017 (UTC) Q15551062 (commons:Psephellus dealbatus) and Q232638 This is straightforward. - Brya (talk) 06:12, 17 March 2017 (UTC) Q8154335 <-> Q45018 needs an experience eye run down it, it seems to be mixed This was the result of my one and only attempt to match taxon to taxon. Took me hours and the result looked bewildering: there was a beautiful match of taxa, but it could only be seen by clicking on each and every page, every time it needed to be consulted. It proved to me that this approach is quite impractical, and that we need to match name to name. - Brya (talk) 15:58, 18 March 2017 (UTC) As someone has time could they please review. Thanks. — billinghurst sDrewth 00:44, 16 March 2017 (UTC) Non extinct bird families With Llywelyn2000 we were working on the following query Items used: bird (Q5113)   , family (Q35409)   , fossil taxon (Q23038290)   , extinct species (Q237350)   Properties used: parent taxon (P171)   , taxon rank (P105)   , instance of (P31)   , IUCN conservation status (P141)   , image (P18)   , taxon name (P225)   SELECT DISTINCT
	?item ?itemLabel ?instanceof ?instanceofLabel ?image ?taxonname
WHERE
{
  	?item wdt:P171* wd:Q5113 .
	?item wdt:P105 wd:Q35409 .
  	?item wdt:P31 ?instanceof . 
  	FILTER NOT EXISTS { ?item wdt:P31 wd:Q23038290 }
  	# FILTER NOT EXISTS { ?item wdt:P141 wd:Q237350 }  # no impact
	OPTIONAL { ?item wdt:P18 ?image }
  	OPTIONAL { ?item wdt:P225 ?taxonname }
   	SERVICE wikibase:label { bd:serviceParam wikibase:language \"en\" . }
} Try it!How can this be improved to exclude extinct families? Should one check conservation status of all included species? Complete and check for temporal range end (P524)? Create a new property? Check for another P31? --- Jura 07:36, 18 March 2017 (UTC) I think your query gives you the desired result. There are only fossile families but no \"exitinct\" families. At the moment we have 154 extinct bird species (IUCN conservation status (P141)= extinct species (Q237350)). --Succu (talk) 11:15, 18 March 2017 (UTC) The above code gives us 357 families, some of these are extinct / fossil. Can we filter those out of the equation / code, please? I understand the figure of live bird families should be c. 170. Thanks! Llywelyn2000 (talk) 18:09, 18 March 2017 (UTC) 1) Some of the fossil families are not marked as such, so these are not filtered out. 2) The c. 170 as the figure of live bird families will be from one particular taxonomic point of view. From a NPoV there will be a lot of families which are recognized by some taxonomists but not by others. - Brya (talk) 04:20, 19 March 2017 (UTC) Ah! Of course! I'll add fossil taxon (Q23038290) to those which are obviously extinct, then, all is done! Many thanks to all! Llywelyn2000 (talk) 06:02, 19 March 2017 (UTC) Oh no: fossil taxon (Q23038290) belongs only with those described from fossil material. Extinct is something different. - Brya (talk) 06:13, 19 March 2017 (UTC) IOC recognises 240 bird families. --Succu (talk) 06:35, 19 March 2017 (UTC) Items used: bird (Q5113)   , species (Q7432)   , family (Q35409)   , fossil taxon (Q23038290)   , extinct species (Q237350)   Properties used: parent taxon (P171)   , taxon rank (P105)   , instance of (P31)   , IUCN conservation status (P141)   , image (P18)   , taxon name (P225)   """@en;
  dcterms:isPartOf <https://www.wikidata.org//wiki/Wikidata_talk:WikiProject_Taxonomy/Archive/2017/03>;
  dcterms:license <https://creativecommons.org/licenses/by-sa/4.0/>;
  sh:prefixes _:wikidata_prefixes;
  schema:target <https://query.wikidata.org/sparql/> .
