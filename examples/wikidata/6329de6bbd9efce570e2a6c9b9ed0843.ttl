@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema: <https://schema.org/> .

<https://www.wikidata.org/#query-6329de6bbd9efce570e2a6c9b9ed0843> a sh:SPARQLExecutable,
    sh:SPARQLSelectExecutable;
  dcterms:isPartOf <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/lb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/th>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/eu>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/en-gb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/vec>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/hy>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/id>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/be-tarask>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/tr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ro>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/he>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/zh>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/pt-br>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/si>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/eo>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/da>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ar>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ko>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/pl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ms>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/sv>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/lt>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/nl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ca>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/uk>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/it>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ja>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/es>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/cs>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ru>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/de>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/fr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/en>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples>;
  dcterms:license <https://creativecommons.org/licenses/by-sa/4.0/>;
  sh:prefixes _:genid-4e694113159d4e3db4a1a913894a81d810226-wikidata_prefixes, _:genid-4e694113159d4e3db4a1a913894a81d810226-5310CE12F6389DF2520902CD537D6D9B,
    _:genid-4e694113159d4e3db4a1a913894a81d810226-68C4CE65D45412E2BEE43C9A5F855BBF, _:genid-4e694113159d4e3db4a1a913894a81d810226-B08F2F3EA059BA0AAE3A0F930258F64D,
    _:genid-4e694113159d4e3db4a1a913894a81d810226-D1C96E502FD304B195562C3224F64564, _:genid-4e694113159d4e3db4a1a913894a81d810226-C701392B56B2A6BE4D36A90BDC21D948,
    _:genid-4e694113159d4e3db4a1a913894a81d810226-A37BA0CF0304717AF129A970D245C511, _:genid-4e694113159d4e3db4a1a913894a81d810226-4A13CB1261B1C728BF96C98AB116B063,
    _:genid-4e694113159d4e3db4a1a913894a81d810226-88974692D14DB938A91D24A96A582639, _:genid-4e694113159d4e3db4a1a913894a81d810226-06D19AC4DAEAC9AD1954B7919EF692BF,
    _:genid-4e694113159d4e3db4a1a913894a81d810226-1B61DEB3A62348083F49CB8EFFD0C05F, _:genid-4e694113159d4e3db4a1a913894a81d810226-24051AB38113725E9AFDB3D01BC3CC0D,
    _:genid-4e694113159d4e3db4a1a913894a81d810226-BC5C138BB4198036B1392BBB23336927, _:genid-4e694113159d4e3db4a1a913894a81d810226-918B0C3193E0D144FC4012E191A8EA9F,
    _:genid-4e694113159d4e3db4a1a913894a81d810226-F94563BC682E3CC422293382CFD2F059, _:genid-4e694113159d4e3db4a1a913894a81d810226-01741FE70E923EA2D61ACAD328174DC7,
    _:genid-4e694113159d4e3db4a1a913894a81d810226-02F05CB18B0119D087A2F6625FF38683, _:genid-4e694113159d4e3db4a1a913894a81d810226-EB7ED20EBBF992BF48251E7124AE5323,
    _:genid-4e694113159d4e3db4a1a913894a81d810226-5E3B5F324371EE26E04FB5C2363A7355, _:genid-4e694113159d4e3db4a1a913894a81d810226-0A4FFEA6C2157795595B808B6D0C6152,
    _:genid-4e694113159d4e3db4a1a913894a81d810226-F63A8403B3A9DEA3856D1CCF42E24E29, _:genid-4e694113159d4e3db4a1a913894a81d810226-A603FCAC09DEA018ED51BB0665505EB2,
    _:genid-4e694113159d4e3db4a1a913894a81d810226-72A74E6AAF37E746CD00DA9B430012C7, _:genid-4e694113159d4e3db4a1a913894a81d810226-78AC5A02FF14AAAC5D70A3F688CA61B8,
    _:genid-4e694113159d4e3db4a1a913894a81d810226-5E3A882FAAA11BC18F50B49F39C75DCC, _:genid-4e694113159d4e3db4a1a913894a81d810226-F5D0244A52D5AADA8BEFE93FF1273AF9,
    _:genid-4e694113159d4e3db4a1a913894a81d810226-2CACBBA096BF42F49170C29FE8EC0E62, _:genid-4e694113159d4e3db4a1a913894a81d810226-833573492114E16BEFDE028C5331CA3D,
    _:genid-4e694113159d4e3db4a1a913894a81d810226-81ACA3849A79D3A72730935B5DA703E0, _:genid-4e694113159d4e3db4a1a913894a81d810226-201D21547190DEAAAE8F98E2BD8DF989,
    _:genid-4e694113159d4e3db4a1a913894a81d810226-5087ACF8A68EE88F4F31DC5B46227C6A, _:genid-4e694113159d4e3db4a1a913894a81d810226-538B00A8E77F7E58FFD5405E10571813,
    _:genid-4e694113159d4e3db4a1a913894a81d810226-210DC0BC9771276BF894F839B5875256, _:genid-4e694113159d4e3db4a1a913894a81d810226-63E75EFC188576E593C92DE7F9EC1D40;
  schema:target <https://query.wikidata.org/sparql/>;
  sh:select """PREFIX wikibase: <http://wikiba.se/ontology#>
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX bd: <http://www.bigdata.com/rdf#>
#defaultView:ScatterChart
PREFIX var_muntype: <http://www.wikidata.org/entity/Q15284>
PREFIX var_area: <http://www.wikidata.org/entity/Q6308>
SELECT ?from (?distNum AS ?kilometers) ?to (?distGrp AS ?animation) WHERE {
  { SELECT ?mun (SAMPLE(?loc) AS ?loc)
    WHERE { ?mun wdt:P31/wdt:P279* var_muntype:;
                 wdt:P131 var_area:;
                 wdt:P625 ?loc. }
    GROUP BY ?mun
  }
  OPTIONAL {
    { SELECT (?mun AS ?mun2) (SAMPLE(?loc) AS ?loc2)
      WHERE { ?mun wdt:P31/wdt:P279* var_muntype:;
                   wdt:P131 var_area:;
                   wdt:P625 ?loc. }
      GROUP BY ?mun
    }
  }
  #FILTER (STR(?mun) <= STR(?mun2)).
  BIND(geof:distance(?loc, ?loc2) AS ?distNum).
  BIND(COALESCE(
    IF(?distNum >= 40, \"40 km und mehr\", 1/0),
    IF(?distNum >= 30, \"30 - 40 km\", 1/0),
    IF(?distNum >= 20, \"20 - 30 km\", 1/0),
    IF(?distNum >= 10, \"10 - 20 km\", 1/0),
    IF(?distNum >= 5, \"05 - 10 km\", 1/0),
    IF(?distNum >= 1, \"01 - 05 km\", \"00 - 01 km\")) AS ?distGrp).

  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],mul,en\".
    ?mun rdfs:label ?from.
    ?mun2 rdfs:label ?to.
  }
}
ORDER BY ?animation ?from ?kilometers""" .
