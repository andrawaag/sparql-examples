@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema: <https://schema.org/> .

<https://www.wikidata.org/#query-7ca965ca99aef83b0372900b8c2ac205> a sh:SPARQLExecutable,
    sh:SPARQLSelectExecutable;
  dcterms:isPartOf <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/maintenance/nl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/maintenance/pl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/maintenance/ja>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/maintenance/cs>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/maintenance/uk>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/maintenance/fr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/maintenance/sv>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/maintenance/es>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/maintenance/en>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/maintenance>,
    <https://www.wikidata.org//wiki/User:Amitie_10g/Sandbox/Wikidata:SPARQL_query_service/queries/examples/maintenance/zh>,
    <https://www.wikidata.org//wiki/User:Amitie_10g/Sandbox/Wikidata:SPARQL_query_service/queries/examples/maintenance/es>,
    <https://www.wikidata.org//wiki/User:Amitie_10g/Sandbox/Wikidata:SPARQL_query_service/queries/examples/maintenance/en>,
    <https://www.wikidata.org//wiki/User:Amitie_10g/Sandbox/Wikidata:SPARQL_query_service/queries/examples/maintenance>;
  dcterms:license <https://creativecommons.org/licenses/by-sa/4.0/>;
  sh:prefixes _:genid-4e694113159d4e3db4a1a913894a81d8986-wikidata_prefixes, _:genid-4e694113159d4e3db4a1a913894a81d8986-3F469E364441E4DD4516900DD1368198,
    _:genid-4e694113159d4e3db4a1a913894a81d8986-C2ECE51AB4E6398EF0F54D02EF02A36B, _:genid-4e694113159d4e3db4a1a913894a81d8986-DE6A191C6395059ADFA65D8DD88168BC,
    _:genid-4e694113159d4e3db4a1a913894a81d8986-429280EFE277C54DD0CD5895755746F2, _:genid-4e694113159d4e3db4a1a913894a81d8986-B37CE945FAC633F37EF681D3EDD26029,
    _:genid-4e694113159d4e3db4a1a913894a81d8986-F79440044F8005B0F60B842D4BBE4DF2, _:genid-4e694113159d4e3db4a1a913894a81d8986-403013B347FDDA5FC043F5AE5E606684,
    _:genid-4e694113159d4e3db4a1a913894a81d8986-3D441FF75C3DF79296BEB9D169AABDF2, _:genid-4e694113159d4e3db4a1a913894a81d8986-6C1664D6CD57DA4DB0B3F18CEF9F7FFD,
    _:genid-4e694113159d4e3db4a1a913894a81d8986-A8501F32235C77A921D95E7026F05ADB, _:genid-4e694113159d4e3db4a1a913894a81d8986-614E3E10336ECDC5D86162747EBBBF79,
    _:genid-4e694113159d4e3db4a1a913894a81d8986-0D9B05014096FD97F58A9E5EA93FCFAD, _:genid-4e694113159d4e3db4a1a913894a81d8986-2145FDAD9A611BD3172ED437F5BFEC87;
  schema:target <https://query.wikidata.org/sparql/>;
  sh:select """PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX prov: <http://www.w3.org/ns/prov#>
PREFIX pr: <http://www.wikidata.org/prop/reference/>
PREFIX p: <http://www.wikidata.org/prop/>
SELECT DISTINCT ?date_range ?date_update (count(?disease) as ?counts)
                (GROUP_CONCAT(?disease ;separator = \"; \") as ?diseases)
                (GROUP_CONCAT(?do_id ;separator = \"; \") as ?doids)
{
  ?disease p:P699/prov:wasDerivedFrom/pr:P813 ?date_update ;
           wdt:P699 ?do_id .
  BIND (now() - ?date_update as ?date_range)
  FILTER (?date_range > 31)
}
GROUP BY ?date_range ?date_update
ORDER BY DESC(?counts)""" .
