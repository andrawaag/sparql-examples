@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema: <https://schema.org/> .

<https://www.wikidata.org/#query-366a961fb9a5475b70c0d1217c2e17b8> a sh:SPARQLExecutable,
    sh:SPARQLSelectExecutable;
  dcterms:isPartOf <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/lb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/th>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/eu>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/en-gb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/vec>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/hy>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/id>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/be-tarask>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/tr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ro>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/he>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/zh>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/pt-br>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/si>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/eo>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/da>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ar>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ko>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/pl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ms>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/sv>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/lt>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/nl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ca>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/uk>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/it>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ja>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/es>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/cs>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ru>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/de>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/fr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/en>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples>;
  dcterms:license <https://creativecommons.org/licenses/by-sa/4.0/>;
  sh:prefixes _:genid-4e694113159d4e3db4a1a913894a81d854557-wikidata_prefixes, _:genid-4e694113159d4e3db4a1a913894a81d854557-E31F643665E9FA86B102A780804FF2EA,
    _:genid-4e694113159d4e3db4a1a913894a81d854557-23117F38FD88276963C8557146B9ECC0, _:genid-4e694113159d4e3db4a1a913894a81d854557-A3B3459E157E500A2BB6C6EBFA961CA5,
    _:genid-4e694113159d4e3db4a1a913894a81d854557-FB81B43EB498BEC7CE9F702151F8ED11, _:genid-4e694113159d4e3db4a1a913894a81d854557-8953920F759FA40791D1A284AFC7EA39,
    _:genid-4e694113159d4e3db4a1a913894a81d854557-92D5203062A63127FEBA843661BBB163, _:genid-4e694113159d4e3db4a1a913894a81d854557-18FF741B9DA855EE58F8A33F52A6404D,
    _:genid-4e694113159d4e3db4a1a913894a81d854557-06C5343E5385D8F50EB8FA0873C9FF62, _:genid-4e694113159d4e3db4a1a913894a81d854557-6B22F236B78E9A0746C8BA97A1039994,
    _:genid-4e694113159d4e3db4a1a913894a81d854557-48E65FD5C8C3BA511E183646EE85EC9A, _:genid-4e694113159d4e3db4a1a913894a81d854557-47CE13B12FB90508CC7FB2B770919C9A,
    _:genid-4e694113159d4e3db4a1a913894a81d854557-B0D4216B4ADDE73B5D5CA5344ECCCFAA, _:genid-4e694113159d4e3db4a1a913894a81d854557-271ED8663B0BF35920B0C5B9146F5A10,
    _:genid-4e694113159d4e3db4a1a913894a81d854557-E26B7FB8D67B54272E2D2EDDC9DCB445, _:genid-4e694113159d4e3db4a1a913894a81d854557-D4E100EE90AD14C7C892E99F5C4444BC,
    _:genid-4e694113159d4e3db4a1a913894a81d854557-CD920BBC8FA33A570D84891876122A14, _:genid-4e694113159d4e3db4a1a913894a81d854557-E21DCC73E5A0514D7B935E692556BA73,
    _:genid-4e694113159d4e3db4a1a913894a81d854557-4A2F420E4F941E7E8018C323B20D0153, _:genid-4e694113159d4e3db4a1a913894a81d854557-F577B67E4D0EF19990A71023AC90DDD1,
    _:genid-4e694113159d4e3db4a1a913894a81d854557-A3017F07CB98AA99CA89B63C85C4D515, _:genid-4e694113159d4e3db4a1a913894a81d854557-64A4B3C6141A99D39A4400A92967D8A0,
    _:genid-4e694113159d4e3db4a1a913894a81d854557-4BFD43D755DA8917FE55D74F21306DDE, _:genid-4e694113159d4e3db4a1a913894a81d854557-CD2B674C69E04CBE3957F7DC837201F7,
    _:genid-4e694113159d4e3db4a1a913894a81d854557-B4CBC7A1B3644E5A0B52E83308CEC027, _:genid-4e694113159d4e3db4a1a913894a81d854557-8FCA22E889AEDCCD681551A159918C28,
    _:genid-4e694113159d4e3db4a1a913894a81d854557-8813508671C9026F4A7F0CC00D95A9E0, _:genid-4e694113159d4e3db4a1a913894a81d854557-D3A802FB24A1D4AD2A5DD3786E6D635F,
    _:genid-4e694113159d4e3db4a1a913894a81d854557-25EF995E15EFC46433B20C5C5C842F6A, _:genid-4e694113159d4e3db4a1a913894a81d854557-C089F0535BECC1C7F12909BD6D02FAE7,
    _:genid-4e694113159d4e3db4a1a913894a81d854557-FF6A906094F72E9A3B4722577765512D, _:genid-4e694113159d4e3db4a1a913894a81d854557-E23DED5B1637B1D0F129F29B97DCAD65,
    _:genid-4e694113159d4e3db4a1a913894a81d854557-A542E259F3EA5F2DD44DDEB992379D73, _:genid-4e694113159d4e3db4a1a913894a81d854557-DBDFEDD2ADAE12B46738388786C8514C;
  schema:target <https://query.wikidata.org/sparql/>;
  sh:select """PREFIX wikibase: <http://wikiba.se/ontology#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX bd: <http://www.bigdata.com/rdf#>
#defaultView:Dimensions
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX wp: <http://vocabularies.wikipathways.org/wp#>
PREFIX dcterms: <http://purl.org/dc/terms/>
SELECT DISTINCT ?wpid ?metaboliteLabel ?pKa ?pKa2 ?metabolite2Label ?wpid2

WHERE {
  {
  SELECT ?wpid ?source_pathway ?metabolite ?pKa ?pKa2 ?metabolite2 ?wpid2
  WHERE {
    # VALUES ?wpid { \"WP550\" }
    ?pathway wdt:P2410 ?wpid ;
             wdt:P527 ?metabolite ;
             wdt:P2888 ?source_pathway .
    ?metabolite wdt:P1117 ?pKa .

    SERVICE <http://sparql.wikipathways.org/sparql> {
      ?wp_mb1 wp:bdbWikidata ?metabolite .
      ?wp_mb1 dcterms:isPartOf ?interaction .
      ?interaction rdf:type wp:Interaction .
      ?wp_mb2 dcterms:isPartOf ?interaction .
      ?wp_mb2 wp:bdbWikidata ?metabolite2 .
      FILTER (?wp_mb1 != ?wp_mb2)
    }
  }
}
  ?metabolite2 wdt:P1117 ?pKa2 .
  ?pathway2 wdt:P2410 ?wpid2 ;
             wdt:P527 ?metabolite2 ;
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],mul,en\". }
}""";
  <http://example.org/bigdata_select> """#defaultView:Dimensions
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX wp: <http://vocabularies.wikipathways.org/wp#>
PREFIX dcterms: <http://purl.org/dc/terms/>
SELECT DISTINCT ?wpid ?metaboliteLabel ?pKa ?pKa2 ?metabolite2Label ?wpid2
WITH {
  SELECT ?wpid ?source_pathway ?metabolite ?pKa ?pKa2 ?metabolite2 ?wpid2
  WHERE {
    # VALUES ?wpid { \"WP550\" }
    ?pathway wdt:P2410 ?wpid ;
             wdt:P527 ?metabolite ;
             wdt:P2888 ?source_pathway .
    ?metabolite wdt:P1117 ?pKa .

    SERVICE <http://sparql.wikipathways.org/sparql> {
      ?wp_mb1 wp:bdbWikidata ?metabolite .
      ?wp_mb1 dcterms:isPartOf ?interaction .
      ?interaction rdf:type wp:Interaction .
      ?wp_mb2 dcterms:isPartOf ?interaction .
      ?wp_mb2 wp:bdbWikidata ?metabolite2 .
      FILTER (?wp_mb1 != ?wp_mb2)
    }
  }
} AS %result
WHERE {
  INCLUDE %result
  ?metabolite2 wdt:P1117 ?pKa2 .
  ?pathway2 wdt:P2410 ?wpid2 ;
             wdt:P527 ?metabolite2 ;
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],mul,en\". }
}""" .
