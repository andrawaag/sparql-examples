@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema: <https://schema.org/> .

<https://www.wikidata.org/#query-69c96d23892ff56e41254904f2d442d6> a sh:SPARQLExecutable,
    sh:SPARQLSelectExecutable;
  dcterms:isPartOf <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial>, <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/lb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/he>, <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/nl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/szl>, <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/en-gb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/zh>, <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/hy>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/tr>, <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/da>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/ar>, <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/ja>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/ca>, <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/sv>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/ru>, <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/uk>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/pl>, <https://www.wikidata.org//wiki/Wikidata:SPARQL_tutorial/en>;
  dcterms:license <https://creativecommons.org/licenses/by-sa/4.0/>;
  sh:prefixes _:genid-4e694113159d4e3db4a1a913894a81d83569-wikidata_prefixes, _:genid-4e694113159d4e3db4a1a913894a81d83569-FC6FEA0718C07A52554F245486FA9D09,
    _:genid-4e694113159d4e3db4a1a913894a81d83569-F27557E0F90068BDFA5D5AEE8FA0E39C, _:genid-4e694113159d4e3db4a1a913894a81d83569-97493471A6F5759D1248FCB620D0C51D,
    _:genid-4e694113159d4e3db4a1a913894a81d83569-64EEE19B0D2C248C5F45C75EECC1B49F, _:genid-4e694113159d4e3db4a1a913894a81d83569-4D87E73C160815BDBAC9DC3F97AB4EAB,
    _:genid-4e694113159d4e3db4a1a913894a81d83569-3E5E1892279F2227FD593E625AE57186, _:genid-4e694113159d4e3db4a1a913894a81d83569-A79DB332C88ADDD7485EB29FC776A675,
    _:genid-4e694113159d4e3db4a1a913894a81d83569-82277A63E266AAD098BFDC6BDA3A5872, _:genid-4e694113159d4e3db4a1a913894a81d83569-FBE8EB87C8168F5239F4553903678823,
    _:genid-4e694113159d4e3db4a1a913894a81d83569-C8E1BA072022892287FFC0F327B3EBCC, _:genid-4e694113159d4e3db4a1a913894a81d83569-3117633E9819385FFF6F501C539F7A12,
    _:genid-4e694113159d4e3db4a1a913894a81d83569-896C117E6EBB920A6EB67FE5F64982A5, _:genid-4e694113159d4e3db4a1a913894a81d83569-A5881A03A70CB9224010DD83D66F46C8,
    _:genid-4e694113159d4e3db4a1a913894a81d83569-1CA74D1A57C907A625186DBB1F07FAB6, _:genid-4e694113159d4e3db4a1a913894a81d83569-856AA425D8084FDFB88518139A825739,
    _:genid-4e694113159d4e3db4a1a913894a81d83569-C4894E51DBB8F056C0DFC9FF4C82AD12, _:genid-4e694113159d4e3db4a1a913894a81d83569-EA2D90EFCF2D16131B99A9F8B7D54758,
    _:genid-4e694113159d4e3db4a1a913894a81d83569-20B45ED65E7C7AAE94C26C4335DF223F;
  schema:target <https://query.wikidata.org/sparql/>;
  sh:select """PREFIX wikibase: <http://wikiba.se/ontology#>
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX bd: <http://www.bigdata.com/rdf#>
SELECT ?publisher ?publisherLabel (AVG(?pages) AS ?avgPages)
WHERE
{
  ?book wdt:P123 ?publisher;
        wdt:P1104 ?pages.
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE]\". }
}
GROUP BY ?publisher ?publisherLabel
HAVING(COUNT(?book) > 1)
ORDER BY DESC(?avgPages)""" .
