@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema: <https://schema.org/> .

<https://www.wikidata.org/#query-df54b00b046540275db69743aef156e7> a sh:SPARQLExecutable,
    sh:SPARQLSelectExecutable;
  rdfs:comment """ This page is an archive. Please do not modify it. Use the current page, even to continue an old discussion. Contents 1 Retrieve researchers without full name 2 Query about writers 3 Past presidents of the GSA with a wikipedia page 4 name of international airports and number of users 5 Hi, I want to map all the places associated with people linked to the merovingian culture (birth place, where they where at which moment). How can I do that, please? 6 Get reference (if persent) and source within wikipedia article for an entry 7 list of pictures with lacking geotag entry 8 Genres to which a name belongs 9 Improve a query -- too many singles values as filter 10 Chess olympiad participantes 11 ASTM standards 12 Public artworks in London by (any) artists.. but depicting females 13 List of any thesis (Q1266946) or master's thesis (Q1907875) in educated at (P69) 14 Items with P244 but no label in English 15 Time out 16 Display incomplete dates 17 Query to find all instances of spacecraft (Q40218) or it's sub-classes 18 Graph of Members Count by Year 19 Longest labels 20 People studied political science (Q36442) 21 Description in a given language 22 African American Athletes 1936 Olympics 23 Getting basic data about taxa 24 Query to get all valid values for symptoms and signs (P780) 25 Get all items with some specific symptoms 26 Format of Pictures 27 Wikidata property related to politics 28 Dbpedia query 29 Canadian politicians 30 Get number of publications for authors with ORCID and working in the Czech Republic - with federated Query 31 Impact Indicators for AfroCine 2.0 32 How many common article has a wikipedia with another wikipedia? 33 Number of Bundesliga matches 34 Get all sitelinks for items linked to a given WikiProject on a given wiki 35 How many items with P1472 represent people vs. organizations? 36 Range of time 37 Architectural structure 38 Identical external IDs Retrieve researchers without full name Many researchers have been imported into Wikidata without the full name in the label, i.e. Josefa Madrid (Q64670894). Most of the elements have an ORCID link, which in this case shows the full name Josefa Madrid. However, locating and correcting thousands of elements manually would take months. The plan is then to make a query to extract all these elements, then I should be able to make a script to extract the full names from ORCID, and finally I can update the elements with the full name using QuickStatements. Can anyone help me making a query that locate people with ORCID iD (P496) and where the label has the syntax J. Madrid? --Cavernia (talk) 07:18, 2 September 2019 (UTC) @Cavernia: Here is a query proposal where I also added a column for the number of sitelinks: SELECT ?item ?itemlabel ?ORCID ?sitelinks {
  ?item wdt:P496 ?ORCID .
  ?item wikibase:sitelinks ?sitelinks .
  ?item rdfs:label ?itemlabel . FILTER(lang(?itemlabel)='en')
  FILTER REGEX (?itemlabel, \"^.\\\\.\")
}
ORDER BY ?itemlabel
 Try it! --Larske (talk) 11:03, 3 September 2019 (UTC) Beautiful, thanks! But 16.236 entries, this script will take som time. --Cavernia (talk) 13:25, 3 September 2019 (UTC) @Cavernia: Almost 29,000 if you also include those without a \".\". SELECT ?item ?itemlabel ?ORCID ?sitelinks {
  ?item wdt:P496 ?ORCID .
  ?item wikibase:sitelinks ?sitelinks .
  ?item rdfs:label ?itemlabel . FILTER(lang(?itemlabel)='en')
  FILTER REGEX (?itemlabel, \"^.[\\\\. ]\")
}
ORDER BY ?itemlabel
 Try it! --Larske (talk) 12:02, 4 September 2019 (UTC) Query about writers Hi. I need a query that allows me to have famous authors from all over the world with their date of birth, death and nationality. I tried using \"remarkable works\" but I didn't know how to filter the result and it inevitably crashes. Thanks! – The preceding unsigned comment was added by [[User:|?]] ([[User talk:|talk]] • contribs).Here's something that'll get you authors who are listed as the author of most books (on Wikidata) # Find prolific authors i.e. authors who are listed as the author of many books
SELECT DISTINCT ?authorLabel ?birthDate ?deathDate ?nationalityLabel ?bookCount WHERE {
  SELECT ?author ?authorLabel ?birthDate ?deathDate ?nationalityLabel (COUNT(?book) AS ?bookCount) WHERE {
    # expand Q571 to include sub-classes of books for more results
    # but this will mostly increase query time
    ?book wdt:P31 wd:Q571;
      wdt:P50 ?author.
    OPTIONAL { ?author wdt:P569 ?birthDate. }
    OPTIONAL { ?author wdt:P570 ?deathDate. }
    OPTIONAL { ?author wdt:P27 ?nationality. }
    SERVICE wikibase:label {
      bd:serviceParam wikibase:language \"en\".
      ?book rdfs:label ?bookLabel.
      ?author rdfs:label ?authorLabel.
      ?nationality rdfs:label ?nationalityLabel.
    }
  }
  GROUP BY ?author ?authorLabel ?birthDate ?deathDate ?nationalityLabel
}
ORDER BY DESC (?bookCount)
 Try it! TheFireBender (talk) 06:30, 7 September 2019 (UTC) Past presidents of the GSA with a wikipedia page I'd like to see the items that link to President of the Geological Society of America (Q60220957) that have an english wikipedia page. I would like to add a category to them. If there was a way to include the link to the wikipedia page, that would be most helpful. Thanks. Trilotat (talk) 19:37, 5 September 2019 (UTC) @Trilotat: SELECT ?item ?itemLabel ?sitelink ?article
WHERE 
{
  ?item wdt:P39 wd:Q60220957 .
  ?sitelink ^schema:name ?article .
  ?article schema:about ?item ;
          schema:isPartOf <https://en.wikipedia.org/> .  
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
}
 Try it! --Tagishsimon (talk) 21:17, 5 September 2019 (UTC) @Tagishsimon: Thanks!! Trilotat (talk) 22:51, 5 September 2019 (UTC) name of international airports and number of users I want to get the name of international airports and number of users in the world.I got the name of the airports easily. However, the number of users has a lot of redundant data.SELECT DISTINCT ?y ?yLabel ?yDescription ?iata ?oh ?pLabel WHERE {
  ?y (wdt:P31/(wdt:P279*)) wd:Q644371.

  OPTIONAL { ?y wdt:P238 ?iata.}
  OPTIONAL { ?y wdt:P856 ?oh. }
  OPTIONAL { ?y wdt:P3872 ?p. }
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"en\". }
}

LIMIT 3000I just want to get the latest data of users. What should I do? Help me please. – The preceding unsigned comment was added by [[User:|?]] ([[User talk:|talk]] • contribs).Random signature and date for archiving User:Jura1 00:01, 1 January 2019 (UTC) It can be done there : SELECT ?item ?itemLabel ?IATA (max(?number) as ?passengers) 
?year
with {
  select ?item  ?IATA ?statement ?year ?timevalue ?numberperperiod{
   ?item wdt:P31/wdt:P279* wd:Q644371.
    ?item wdt:P238 ?IATA.    
    ?item p:P3872 ?statement.
    ?statement pqv:P585 ?timevalue
               ; ps:P3872 ?numberperperiod.
    ?timevalue wikibase:timeValue ?date .
    optional { ?statement pq:P518 ?applies .}
filter(bound(?applies)=false || ?applies = wd:Q2165236 )
bind(if(bound(?applies)=false,\"no applies\",\"everywhere\") as ?where )
MINUS { ?statement wikibase:rank wikibase:DeprecatedRank }
bind (YEAR(?date) AS ?year)
FILTER (?year >1949).
FILTER (?year < year(now())).
}
} as %airport
where {
  {
select ?item ?year (sum(?numberperperiod) as ?number) {
include %airport .
?timevalue wikibase:timePrecision ?prec filter ( ?prec > 9 )
} group by ?item  ?year
  } union {
      ?timevalue wikibase:timePrecision 9 .
    bind (?numberperperiod as ?number)
      include %airport
  } .
    SERVICE wikibase:label { bd:serviceParam wikibase:language \"fr\". }
} group by ?item ?itemLabel ?year ?IATA
order by ?item desc (?year)
 Try it! Bouzinac (talk) 18:20, 8 September 2019 (UTC) Hi, I want to map all the places associated with people linked to the merovingian culture (birth place, where they where at which moment). How can I do that, please? Hi, I want to map all the places associated with people linked to the merovingian culture (birth place, where they where at which moment). How can I do that, please? – The preceding unsigned comment was added by [[User:|?]] ([[User talk:|talk]] • contribs). Random signature and date for archiving --- Jura 12:30, 8 September 2019 (UTC) Get reference (if persent) and source within wikipedia article for an entry Hello,I wanted originating source text for a subject relation object triplet within wikipedia and any reference if present.My query is: SELECT DISTINCT (?X as ?A1) (?Y as ?A2) WHERE { ?M wdt:PXXX ?N . ?N rdfs:label ?X . filter (lang(?X)=\"en\")}I want the results to look like A1     A2         reference
car    vehicle    link to reference
bat    animal     link to reference
cat    feline     None
loose  little     None A more tricky one would be this, if someone can help with it, for links https://www.wikidata.org/wiki/Q591787 and https://www.wikidata.org/wiki/Q36 and properties 'successful candidate' and 'located in or next to body of water' respectively: A1                                       A2                            Wikipedia source
name of page                             value of property             \"sentence within wikipedia which mentions A1 and A2 if any\" 
2009 South African general election      Jacob Gedleyihlekisa Zuma     \" ... being the election of Jacob Zuma to the party presidency ahead ...\"
Poland                                   Baltic Sea                    \"... Poland is bordered by the Baltic Sea ...\" Thanks and hoping to hear from you all. – The preceding unsigned comment was added by [[User:|?]] ([[User talk:|talk]] • contribs). Interesting question. --- Jura 12:25, 8 September 2019 (UTC) list of pictures with lacking geotag entry It would be great to ge a list of pictures in commons without geocoordinates which are embedded in an article in de:wikipedia with geocoordinates or in a wikidata-object with geocoordinates list of pictures in de:wikipedia without geocoordinates which are embedded in an article in de:wikipedia with geocoordinates or in a wikidata-object with geocoordinates Would be nice if one could limit the results to a certain range around the given geocoordinates.Maybe there is already a tool around to simplify the process of copying from / linking to the geocoordinates from the counterparts in other Wikipedia projects. --EvK (talk) 13:18, 7 September 2019 (UTC) I don't think this can currently be done with SPARQL. Maybe a usecase to present at c:Commons:Structured data (coordinates would be just one property to check for). Maybe there is a way to do it with categories and/or https://quarry.wmflabs.org/ . --- Jura 12:23, 8 September 2019 (UTC) Genres to which a name belongs I have this query: The following query uses these:Items: given name (Q202444)   Properties: instance of (P31)   , subclass of (P279)   , language of work or name (P407)   SELECT DISTINCT ?name ?nameLabel ?langLabel
WHERE
{
  ?name wdt:P31/wdt:P279* wd:Q202444. # Instance or subclass of name
  ?name wdt:P407 ?lang.
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
} Try it! How do I also show if a name is part of male given name (Q12308941), female given name (Q11879590) and/or unisex given name (Q3409032)? --181.12.31.116 06:48, 8 September 2019 (UTC) Like this SELECT DISTINCT ?name ?nameLabel ?langLabel ?typeLabel
WHERE
{
  ?name wdt:P31/wdt:P279* wd:Q202444. # Instance or subclass of name
  ?name wdt:P407 ?lang.
  ?name wdt:P31 ?type .
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
}
 Try it! Although this finds some other name types. You can constrain it to your three suggestions using VALUES ?type {wd:Q12308941 wd:Q11879590 wd:Q3409032}. The idea is to get the names of people so filtering them using VALUES helps me, thank you.--181.12.31.116 12:07, 8 September 2019 (UTC) Improve a query -- too many singles values as filter Hellois there a way to filter any border that are part of European Union border (Q67147037) so as to simplify this query ?? #defaultView:Map
SELECT ?item ?itemLabel ?coord WHERE {
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
  ?item wdt:P31 wd:Q757292 .
  ?item wdt:P361 ?partiede.
   MINUS { ?item wdt:P576 _:b2. }
     MINUS { ?item wdt:P361 wd:Q3089219. }
  FILTER ( ?partiede IN ( wd:Q603662, #Estonie, Russie
                         wd:Q495735, #Finlande, Russie
                         wd:Q2453561,#Lituanie, Russie
                         wd:Q2630440,#Lettonie, Russie
                         wd:Q966245,#Biélorussie, Lettonie
                         wd:Q2623774,#Biélorussie, Lituanie
                         wd:Q1993022, #Hongrie, Ukraine
                         wd:Q2630766,#Slovaquie, Ukraine
                         wd:Q2499730, #Biélorussie, Pologne
                         wd:Q2708432, #Pologne, Ukraine
                         wd:Q782109, #Pologne, Russie
                         wd:Q2453169, #Roumanie, Ukraine
                         wd:Q3088972, #Roumanie, Serbie
                         wd:Q3088866 #Bulgarie, Serbie
                         ,wd:Q3088942 #Hongrie, Serbie
                         ,wd:Q3088864 #Bulgarie, Macédoine N
                         ,wd:Q3088922 #Grèce, Turquie
                         ,wd:Q3088686 #Grèce, Albanie
                         ,wd:Q641617 #Croatie, Serbie
                         ,wd:Q576324 #Bosnie, Croatie
                         ,wd:Q3088891 #Croatie, Monténégro
                         ,wd:Q1991697 #France Suisse
                         ,wd:Q1996372 #France Monaco
                         ,wd:Q2009420#France Andorre
                         ,wd:Q3088648#Akrotiri
                         ,wd:Q2467764#Andorre et Espagne
                         ,wd:Q2573418#France et Brésil
                         ,wd:Q1991324#Liecht et Autriche
                         ,wd:Q3088921 #Grèce et Macédoine
                         ,wd:Q2748217#Espagne et Maroc
                         ,wd:Q2631181#Moldavie et Roumanie
                         ,wd:Q2742785#Norvège et Suède
                         ,wd:Q2913944#Norvège et Finlande
                         ,wd:Q1991264#italie et saint marin
                         ,wd:Q1996259#France et Pays bas et oui!
                         ,wd:Q1991810#Suisse et Allemagne
                         ,wd:Q664063#Suisse et italie
                         ,wd:Q3088913#france et surinam
                        ,wd:Q3088873#Bulgarie et turquie
                        ,wd:Q2457562#Italie et vatican
) )
  OPTIONAL { ?item wdt:P625 ?coord. }
}
 Try it! @Bouzinac: Something like this, probably. Seems to find more rows than yours, though. #defaultView:Map
SELECT distinct ?item ?itemLabel ?coord WHERE {
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
  { ?item wdt:P31/wdt:P279* wd:Q67147037 . }
  union
  { ?item wdt:P361/wdt:P31/wdt:P279* wd:Q67147037 . }
  MINUS { ?item wdt:P576 _:b2. }
  MINUS { ?item wdt:P361 wd:Q3089219. }
  OPTIONAL { ?item wdt:P625 ?coord. }
}
 Try it! or this, which seems to do much the same thing: #defaultView:Map
SELECT distinct ?item ?itemLabel ?coord WHERE {
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
  ?item wdt:P361*/wdt:P31/wdt:P279* wd:Q67147037 . 
  MINUS { ?item wdt:P576 _:b2. }
  MINUS { ?item wdt:P361 wd:Q3089219. }
  OPTIONAL { ?item wdt:P625 ?coord. }
}
 Try it! --Tagishsimon (talk) 20:13, 8 September 2019 (UTC) The last one looks nice and has a very simple and readable query, but should excludes border in themselves (like Moldova–Romania border (Q2631181), so query should only present border checkpoints and any physical border crossing. Thanks again ! Bouzinac (talk) 20:56, 8 September 2019 (UTC) @Bouzinac: As easy as this to fix, I think (although I'm not paying too much attention; tell me if I'm off-beam). #defaultView:Map
SELECT distinct ?item ?itemLabel ?coord WHERE {
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
  ?item wdt:P31 wd:Q757292 .
  ?item wdt:P361*/wdt:P31/wdt:P279* wd:Q67147037 . 
  MINUS { ?item wdt:P576 _:b2. }
  MINUS { ?item wdt:P361 wd:Q3089219. }
  OPTIONAL { ?item wdt:P625 ?coord. }
}
 Try it! --Tagishsimon (talk) 00:05, 9 September 2019 (UTC) Thanks! So we have two interesting maps : one being the (not 100% complete) map of each European Union checkpoint (European Union side) https://w.wiki/89M : 95 dots one being the (close to 100% complete) map of each border crossing of Northern Ireland/Ireland https://w.wiki/89J : 290 dots Bouzinac (talk) 09:00, 10 September 2019 (UTC) Chess olympiad participantes I am looking for all chess players that have OlimpBase Chess Olympiad player ID (P3940), but not participant in (P1344): <instance of chess olympiad>. This is what I tried and what does not work: SELECT DISTINCT ?item ?itemLabel
WHERE
{
	?item wdt:P3940 ?value .
    ?olymp wdt:P31 wd:Q428303 .
	MINUS { ?item wdt:P1344 ?olymp }
	SERVICE wikibase:label { bd:serviceParam wikibase:language \"de,en\" } .
}
LIMIT 1000
 Try it! Steak (talk) 20:13, 8 September 2019 (UTC) @Steak: This, I think: SELECT DISTINCT ?item ?itemLabel
WHERE
{
  ?item wdt:P3940 ?value .
  MINUS { ?item wdt:P1344 ?olymp .
  ?olymp wdt:P31 wd:Q428303 .
         }
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"de,en\" } .
}
LIMIT 1000
 Try it! --Tagishsimon (talk) 20:20, 8 September 2019 (UTC) Looks good, thanks. The only change is to define ?olymp inside the MINUS and not before. Why does this make a difference? Steak (talk) 20:24, 8 September 2019 (UTC) I think its possibly bottom-up semantics - https://blog.blazegraph.com/?p=954 ... because it exists in a subclause MINUS { ?item wdt:P1344 ?olymp . cannot see the values found for ?olymp ... is my vague understanding. --Tagishsimon (talk) 21:09, 8 September 2019 (UTC) ASTM standards I’m trying to get a list of the ASTM standards which have been wrongly tagged as the scholarly article (Q13442814). The DOI (P356) for these items starts with one of the (10.1520/A, 10.1520/B, … 10.1520/G). I tried the following query but I’m getting the timeout error. Can anyone please optimize my query? Many thanks! -- Meisam (talk) 10:09, 10 September 2019 (UTC) SELECT ?item ?doi WHERE {
  ?item wdt:P31 wd:Q13442814;
    wdt:P356 ?doi.
  FILTER(CONTAINS(?doi, \"10.1520/A\"))
}
 Try it! @Meisam: Maybe search could do? Special:Search/ASTM haswbstatement:P31=Q13442814 --- Jura 14:59, 10 September 2019 (UTC) @Jura1: Unfortunately, most of the standards don’t have ASTM in their title (e.g. ASTM D6043 (Q59379325)). I couldn’t find a way to search for something like “10.1520/A” (“/” is troublesome!). Also, the results of the search for the DOI-prefix alone includes lots of genuine article items which have been published in the ASTM journals (e.g. Using brain MERMER testing to detect knowledge despite efforts to conceal (Q28201707)). But including haswbstatement:P31=Q13442814 in the search gives some useful results! I must be able to filter through the results myself. Thanks! -- Meisam (talk) 15:10, 10 September 2019 (UTC) Public artworks in London by (any) artists.. but depicting females Looking at the query posted above (see \"Public artworks in London by female artists\"), I was wondering how you modify this to show artworks that depicts (P180) females? For some reason a woman (Q467) is not female (Q6581072), but only a subclass of female, which causes the query to skip all \"unnamed\" or \"unknown\" women. Jane023 (talk) 12:30, 10 September 2019 (UTC) @Jane023: Probably along these sorts of lines SELECT ?item ?itemLabel WHERE 
{ 
  ?item wdt:P136 wd:Q557141 .              # public art
  ?item wdt:P131* wd:Q23939248 .           # in London
  {?item wdt:P180/wdt:P21 wd:Q6581072 .}   # P180 depicts an item which has a P21 sex or gender of female
  UNION                                    # together with
  {?item wdt:P180/wdt:P279* wd:Q6581072 .} # P180 depicts an item which is a P279* subclass of female
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
}
 Try it! --Tagishsimon (talk) 13:13, 10 September 2019 (UTC) Super, thanks! I forgot all about the series of portrait lists I made which prompted the question. Now I have to fix them all, but here is your solution in action: Wikidata:WikiProject Men/Portraits of Men 1490-1499. Jane023 (talk) 13:26, 10 September 2019 (UTC) List of any thesis (Q1266946) or master's thesis (Q1907875) in educated at (P69) Looking for items with educated at (P69) that have qualifiers thesis (Q1266946) or master's thesis (Q1907875) AND master's degree (Q183816), Master of Arts (Q2091008), or Master of Science (Q950900). Essentially, I'm hoping to see who has a dissertation/dissertation as qualifier for a masters degree. Thanks. Trilotat (talk) 14:22, 10 September 2019 (UTC) Items with P244 but no label in English I'm struggling to get more than 1000 results before it times out. Is there a way to optimize this so I can get a larger pool of results? Thanks! Gamaliel (talk) 13:26, 11 September 2019 (UTC) SELECT ?item ?LCCN WHERE {
 ?item wdt:P31 wd:Q5.  #instance of human
 ?item wdt:P244 ?LCCN

 SERVICE wikibase:label { bd:serviceParam wikibase:language \"en\". }
 FILTER(NOT EXISTS {
   ?item rdfs:label ?lang_label.
   FILTER(LANG(?lang_label) = \"en\")  
 })
}
 Try it! @Gamaliel: perhaps this sort of direction? The example below gets north of 7k rows. Use offset 300000 limit 300000 & so on for the next sets of matches ... iirc there are 1.6M LCCNs to work through, so ~6 runs of this /might/ get all matching rows. SELECT ?item ?LCCN with { SELECT ?item ?LCCN WHERE {
 ?item wdt:P244 ?LCCN .
} limit 300000 } as %i where
{
  include %i
  ?item wdt:P31 wd:Q5 .
  OPTIONAL { ?item rdfs:label ?lang_label . FILTER(LANG(?lang_label) = \"en\")}
  FILTER(!BOUND(?lang_label))
}
 Try it! --Tagishsimon (talk) 22:34, 11 September 2019 (UTC) I got 7694 results with this much faster than it took to get 1000 with the old query. Thanks Tagishsimon! Gamaliel (talk) 02:15, 12 September 2019 (UTC) Nice. I added it as complex constraint to Property talk:P244 --- Jura 05:52, 12 September 2019 (UTC) Time out Hello I was trying to show checkpoint on borders for current Schengen countries. It times out... ? #defaultView:Map
SELECT distinct ?item ?itemLabel ?coord WHERE {
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
  ?item wdt:P31 wd:Q757292 .#checkpoints
   ?item wdt:P17*/wdt:P463* wd:Q1969730. #Belongs to Schengen zone
  MINUS { ?item wdt:P576 _:b2. } #Remove dissolved
  MINUS { ?item wdt:P361 wd:Q3089219. } #Remove maritime borders
MINUS { ?item wdt:P361 wd:Q700754. } #Remove RFA-RDA borders
  MINUS { ?item wdt:P361 wd:Q67218438. } #Remove air borders
  OPTIONAL { ?item wdt:P625 ?coord. }
}
 Try it!Bouzinac (talk) 19:19, 11 September 2019 (UTC)@Bouzinac: Three changes: use of named subquery; use of gearing hint; change P17* to P17. One or more of these probably helped. #defaultView:Map
SELECT distinct ?item ?itemLabel ?coord with {select ?item WHERE {
  ?item wdt:P31 wd:Q757292 .#checkpoints
  ?item wdt:P17/wdt:P463* wd:Q1969730. #Belongs to Schengen zone
   hint:Prior hint:gearing \"forward\".
  } } as %i where
{
  include %i
  MINUS { ?item wdt:P576 _:b2. } #Remove dissolved
  MINUS { ?item wdt:P361 wd:Q3089219. } #Remove maritime borders
MINUS { ?item wdt:P361 wd:Q700754. } #Remove RFA-RDA borders
  MINUS { ?item wdt:P361 wd:Q67218438. } #Remove air borders
  OPTIONAL { ?item wdt:P625 ?coord. }
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
}
 Try it! --Tagishsimon (talk) 21:20, 11 September 2019 (UTC) Hey Tagishsimon, thank you but still timing out. What's all the more weirdo is that this one functions very well (but Schengen is not European Union) #defaultView:Map
SELECT distinct ?item ?itemLabel ?coord WHERE {
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
  ?item wdt:P31 wd:Q757292 .#checkpoints
  ?item wdt:P361*/wdt:P31/wdt:P279* wd:Q67147037 . #located on a UE border
  ?item wdt:P17*/wdt:P463* wd:Q458. #in a European Union country
  #?item wdt:P17*/wdt:P463* wd:Q1969730. #Belongs to Schengen zone
  MINUS { ?item wdt:P576 _:b2. } #Remove dissolved
  MINUS { ?item wdt:P361 wd:Q3089219. } #Remove maritime borders
MINUS { ?item wdt:P361 wd:Q700754. } #Remove RFA-RDA borders
  MINUS { ?item wdt:P361 wd:Q67218438. } #Remove air borders
  OPTIONAL { ?item wdt:P625 ?coord. }
}
 Try it! Does it mean I have to input a Q like \"border of Schengen Area\", based on this one European Union border (Q67147037) ? Bouzinac (talk) 05:36, 12 September 2019 (UTC) OK, looks definitely better with #defaultView:Map
SELECT distinct ?item ?itemLabel ?coord WHERE {
  SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\". }
  ?item wdt:P31 wd:Q757292 .#checkpoints
  ?item wdt:P361*/wdt:P31/wdt:P279* wd:Q67371697 . #located on a Schengen border
MINUS { ?item wdt:P576 _:b2. } #Remove dissolved
MINUS { ?item wdt:P361 wd:Q17163396. } #Remove open borders
MINUS { ?item wdt:P361 wd:Q3089219. } #Remove maritime borders
MINUS { ?item wdt:P361 wd:Q700754. } #Remove RFA-RDA borders
MINUS { ?item wdt:P361 wd:Q67218438. } #Remove air borders
OPTIONAL { ?item wdt:P625 ?coord. }
}
 Try it! Bouzinac (talk) 11:15, 12 September 2019 (UTC) Display incomplete dates This request don't display dates properly. If the day and month of a date are not spécified, it display 1 january instead of only the year. SELECT ?item ?nameLabel ?itemLabel ?itemDescription ?birthdate ?birthplaceLabel ?deathdate ?deathplaceLabel
WHERE
{
    ?item wdt:P119 wd:Q1457377 .
    OPTIONAL {?item wdt:P734 ?name }
    OPTIONAL {?item wdt:P569 ?birthdate } 
    OPTIONAL {?item wdt:P19 ?birthplace }
    OPTIONAL {?item wdt:P570 ?deathdate }
    OPTIONAL {?item wdt:P20 ?deathplace }
    SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\" }
}
ORDER BY (?nameLabel)
 Try it! This is all about date precision, in which dates in wikidata are stored to a certain level of precision; and if rendered without considering precision, yield for instance the 1/1/YYYY you're seeing. It's possible to identify the level of precision in a date, which I do in the query below, and then use that info either to filter out imprecise dates, or else to drive some sort of IF statement which presents only the year for precision=9, month & year for precision=10 & ddmmyyy for precision=11 ... roughly as below: SELECT ?item ?nameLabel ?itemLabel ?itemDescription  ?datebirth ?precDoB ?datedeath ?precDoD
WHERE
{
    ?item wdt:P119 wd:Q1457377 .
    OPTIONAL {?item wdt:P734 ?name }
    OPTIONAL {?item p:P569 [ps:P569 ?birthdate; psv:P569 [wikibase:timePrecision ?precDoB] ] .
      BIND(IF(?precDoB=11,concat(str(year(?birthdate)),\" \",if(strlen(str(month(?birthdate)))=1,concat(\"0\",str(month(?birthdate))),str(month(?birthdate))),\" \",if(strlen(str(day(?birthdate)))=1,concat(\"0\",str(day(?birthdate))),str(day(?birthdate)))),
             if(?precDoB=10,concat(str(year(?birthdate)),\" \",if(strlen(str(month(?birthdate)))=1,concat(\"0\",str(month(?birthdate))),str(month(?birthdate)))),
               if(?precDoB=9,year(?birthdate),\"\"))) as ?datebirth)             
             } 
    OPTIONAL {?item wdt:P19 ?birthplace }
    OPTIONAL {?item wdt:P570 ?deathdate }
    OPTIONAL {?item p:P570 [ps:P570 ?deathdate; psv:P570 [wikibase:timePrecision ?precDoD] ] .
      BIND(IF(?precDoD=11,concat(str(year(?deathdate)),\" \",if(strlen(str(month(?deathdate)))=1,concat(\"0\",str(month(?deathdate))),str(month(?deathdate))),\" \",if(strlen(str(day(?deathdate)))=1,concat(\"0\",str(day(?deathdate))),str(day(?deathdate)))),
             if(?precDoD=10,concat(str(year(?deathdate)),\" \",if(strlen(str(month(?deathdate)))=1,concat(\"0\",str(month(?deathdate))),str(month(?deathdate)))),
               if(?precDoD=9,year(?deathdate),\"\"))) as ?datedeath)
             } 
    OPTIONAL {?item wdt:P20 ?deathplace }
    SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\" }
}
ORDER BY ?precDoD ?nameLabel
 Try it! --Tagishsimon (talk) 22:10, 11 September 2019 (UTC) @Tagishsimon: Is there a way to diplay dates as usual : March 1896 ? --Yanik B 11:16, 12 September 2019 (UTC) @YanikB: There might some simpler way, but in the following modified query you get the \"usual\" format, but you have to state the preferred language. SELECT ?item ?nameLabel ?itemLabel ?itemDescription  ?datebirth ?datebirth_alt ?precDoB ?datedeath ?precDoD
WHERE
{
    ?item wdt:P119 wd:Q1457377 .
    OPTIONAL {?item wdt:P734 ?name }
    OPTIONAL {?item p:P569 [ps:P569 ?birthdate; psv:P569 [wikibase:timePrecision ?precDoB] ] .
    BIND(IF(?precDoB=11,concat(str(year(?birthdate)),\" \",if(strlen(str(month(?birthdate)))=1,concat(\"0\",str(month(?birthdate))),str(month(?birthdate))),\" \",if(strlen(str(day(?birthdate)))=1,concat(\"0\",str(day(?birthdate))),str(day(?birthdate)))),
             if(?precDoB=10,concat(str(year(?birthdate)),\" \",if(strlen(str(month(?birthdate)))=1,concat(\"0\",str(month(?birthdate))),str(month(?birthdate)))),
               if(?precDoB=9,year(?birthdate),\"\"))) as ?datebirth)
 
 # --- alternative format for birth date, similar can be done for death date            
      ?month wdt:P31 wd:Q47018901; wdt:P279 wd:Q18602249; wdt:P1545 ?monthnumber .  FILTER(?monthnumber=STR(MONTH(?birthdate)))
      ?month rdfs:label ?monthname . FILTER(lang(?monthname)='en')
      BIND(IF(?precDoB=11,?birthdate,IF(?precDoB=10,CONCAT(STR(?monthname),' ',STR(YEAR(?birthdate))),YEAR(?birthdate))) AS ?datebirth_alt)             
 # ---   
              
             } 
    OPTIONAL {?item wdt:P19 ?birthplace }
    OPTIONAL {?item wdt:P570 ?deathdate }
    OPTIONAL {?item p:P570 [ps:P570 ?deathdate; psv:P570 [wikibase:timePrecision ?precDoD] ] .
      BIND(IF(?precDoD=11,concat(str(year(?deathdate)),\" \",if(strlen(str(month(?deathdate)))=1,concat(\"0\",str(month(?deathdate))),str(month(?deathdate))),\" \",if(strlen(str(day(?deathdate)))=1,concat(\"0\",str(day(?deathdate))),str(day(?deathdate)))),
             if(?precDoD=10,concat(str(year(?deathdate)),\" \",if(strlen(str(month(?deathdate)))=1,concat(\"0\",str(month(?deathdate))),str(month(?deathdate)))),
               if(?precDoD=9,year(?deathdate),\"\"))) as ?datedeath)
             } 
    OPTIONAL {?item wdt:P20 ?deathplace }
    SERVICE wikibase:label { bd:serviceParam wikibase:language \"[AUTO_LANGUAGE],en\" }
}
ORDER BY ?precDoD ?nameLabel
 Try it! } Please note that the code only takes care of the values 11 (day), 10 (month), and 9 (year) for timePrecision. There might be dates with less precision than year. --Larske (talk) 16:25, 12 September 2019 (UTC) Shouldn't have a service on query server that could do that? --- Jura 19:31, 13 September 2019 (UTC) Query to find all instances of spacecraft (Q40218) or it's sub-classes I tried this SELECT DISTINCT ?item ?itemLabel {
  ?item wdt:P31* wd:Q40218
  OPTIONAL { ?item wdt:P31 ?linkTo }
  SERVICE wikibase:label {bd:serviceParam wikibase:language \"en\" }
} Try it!But it does not include Discovery (Q54384)This does include Discovery (Q54384) but it also includes Space Shuttle orbiter (Q1064394) which is not an instance of spacecraft (Q40218) """@en;
  dcterms:isPartOf <https://www.wikidata.org//wiki/Wikidata:Request_a_query/Archive/2019/09>,
    <https://www.wikidata.org//wiki/User:Iwan.Aucamp/Trash>;
  dcterms:license <https://creativecommons.org/licenses/by-sa/4.0/>;
  sh:prefixes _:genid-4e694113159d4e3db4a1a913894a81d840001-wikidata_prefixes, _:genid-4e694113159d4e3db4a1a913894a81d840001-6A77C39299CD8D4D3E57F0A0D98C9326;
  schema:target <https://query.wikidata.org/sparql/>;
  sh:select """PREFIX wikibase: <http://wikiba.se/ontology#>
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX wd: <http://www.wikidata.org/entity/>
PREFIX bd: <http://www.bigdata.com/rdf#>
SELECT DISTINCT ?item ?itemLabel {
  ?item (wdt:P31*/wdt:P279*) wd:Q40218
  OPTIONAL { ?item wdt:P31 ?linkTo }
  SERVICE wikibase:label {bd:serviceParam wikibase:language \"en\" }
}""" .
