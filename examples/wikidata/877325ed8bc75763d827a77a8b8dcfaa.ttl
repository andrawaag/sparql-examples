@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema: <https://schema.org/> .

<https://www.wikidata.org/#query-877325ed8bc75763d827a77a8b8dcfaa> a sh:SPARQLExecutable,
    sh:SPARQLSelectExecutable;
  dcterms:isPartOf <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/lb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/th>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/eu>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/en-gb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/vec>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/hy>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/id>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/be-tarask>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/tr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ro>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/he>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/zh>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/pt-br>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/si>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/eo>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/da>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ar>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ko>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/pl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ms>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/sv>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/lt>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/nl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ca>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/uk>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/it>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ja>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/es>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/cs>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/ru>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/de>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/fr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples/en>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/queries/examples>;
  dcterms:license <https://creativecommons.org/licenses/by-sa/4.0/>;
  sh:prefixes _:genid-4e694113159d4e3db4a1a913894a81d813631-wikidata_prefixes, _:genid-4e694113159d4e3db4a1a913894a81d813631-08951BF291A5C1CDCA3454791E014816,
    _:genid-4e694113159d4e3db4a1a913894a81d813631-FC712411BD3A4682B0DA6119F13D82E2, _:genid-4e694113159d4e3db4a1a913894a81d813631-6150A12B87193FC9257049AC313A6EC3,
    _:genid-4e694113159d4e3db4a1a913894a81d813631-01F08813276404552AC1B695060C7EC9, _:genid-4e694113159d4e3db4a1a913894a81d813631-34FF41ED0625BC65215180C77ECC0F44,
    _:genid-4e694113159d4e3db4a1a913894a81d813631-47D6E1D558C7F5D54600CB2D1271A5B7, _:genid-4e694113159d4e3db4a1a913894a81d813631-06EA9593F80B96EAE57646D654DB18C8,
    _:genid-4e694113159d4e3db4a1a913894a81d813631-E5D94E69195E079C35707A751470B688, _:genid-4e694113159d4e3db4a1a913894a81d813631-3D9AB87E3266D465D563B61E9C9C497D,
    _:genid-4e694113159d4e3db4a1a913894a81d813631-EA1CF280990C6C2ACB1E88235EC1AE86, _:genid-4e694113159d4e3db4a1a913894a81d813631-C0819161B409C81A479361FE9D8FF95A,
    _:genid-4e694113159d4e3db4a1a913894a81d813631-A55D363C8F8D9B7560B657A8F2B8271B, _:genid-4e694113159d4e3db4a1a913894a81d813631-FCBF6FAD4ECDFF5742CC258F0011CE29,
    _:genid-4e694113159d4e3db4a1a913894a81d813631-FECD5AC12EF0C8327637737649EC518F, _:genid-4e694113159d4e3db4a1a913894a81d813631-F5621DA35A4A089DAE635EF19BF30AC5,
    _:genid-4e694113159d4e3db4a1a913894a81d813631-B654AF0DCDD800C952DC30D0E044261F, _:genid-4e694113159d4e3db4a1a913894a81d813631-5E204067CABA2027FC5BA22728C8D4EF,
    _:genid-4e694113159d4e3db4a1a913894a81d813631-2066622798C7ABC9529C92C69A04BC46, _:genid-4e694113159d4e3db4a1a913894a81d813631-CA0E5C3744A9F76A78C51BC539894761,
    _:genid-4e694113159d4e3db4a1a913894a81d813631-A1F7AC51D322292D1EEE37A434E4CEC3, _:genid-4e694113159d4e3db4a1a913894a81d813631-B5AB462DEDA79DC003870249F0E2EF8A,
    _:genid-4e694113159d4e3db4a1a913894a81d813631-50DCC1E800496F9E266106F9E9A937EB, _:genid-4e694113159d4e3db4a1a913894a81d813631-A0642F3098A5E5CBA4C14EC6E19C1137,
    _:genid-4e694113159d4e3db4a1a913894a81d813631-FF805457F33EDA2C2539ACCB294C7FF5, _:genid-4e694113159d4e3db4a1a913894a81d813631-5C245E37A01993FEE2D3BEE2AA7EDE21,
    _:genid-4e694113159d4e3db4a1a913894a81d813631-F718D9E8C27E883819256E03C80E8723, _:genid-4e694113159d4e3db4a1a913894a81d813631-F46504016049DBAA18DEEBBEE8595692,
    _:genid-4e694113159d4e3db4a1a913894a81d813631-F4170345AF09041DEDFAA3E5B66FB8BF, _:genid-4e694113159d4e3db4a1a913894a81d813631-3C35DB4E451FBF4218FE5CD68F4435B5,
    _:genid-4e694113159d4e3db4a1a913894a81d813631-8DF92E5BE6E19752FA3885EFA45C961F, _:genid-4e694113159d4e3db4a1a913894a81d813631-B5A28E4A6ED78E0A1BD4AC0A311961A1,
    _:genid-4e694113159d4e3db4a1a913894a81d813631-80162E313A621DFB01057F58F859A71E, _:genid-4e694113159d4e3db4a1a913894a81d813631-1DCEEB780821EB1AAC4E29FD7E7B1C75;
  schema:target <https://query.wikidata.org/sparql/>;
  sh:select """PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX wd: <http://www.wikidata.org/entity/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
SELECT
  ?item
  (SAMPLE (?titleL) AS ?title)
  (group_concat(DISTINCT ?creatorL ; separator = \", \") as ?creator)
  (group_concat(DISTINCT ?genreL ; separator = \", \") as ?genre)
  (group_concat(DISTINCT ?placeL ; separator = \", \") as ?place)
  (group_concat(DISTINCT ?arr ; separator = \", \") as ?arrondissement)
  (SAMPLE (?img) AS ?image)
  (SAMPLE (?coord) AS ?coordinates) {

    {
      SELECT DISTINCT ?item { {
        ?item wdt:P136 wd:Q557141 ;     # genre: public art
              wdt:P131 wd:Q90           # located in: Paris
      } UNION { # or
        ?item wdt:P136 wd:Q557141 ;     # genre: public art
              wdt:P131/wdt:P131* wd:Q90 # located in an arrondissement of Paris
      } }
    }

    # title
    OPTIONAL { ?item rdfs:label ?titleL FILTER (lang(?titleL) = \"fr\") }

    # creators
    OPTIONAL { ?item wdt:P170 [rdfs:label ?creatorL] FILTER (lang(?creatorL) = \"fr\") }

    #genre
    OPTIONAL {
      {
        ?item wdt:P136 ?g FILTER (STR(?g) != 'http://www.wikidata.org/entity/Q557141')
      } UNION {
        ?item wdt:P31 ?g .
      }
      ?g rdfs:label ?genreL FILTER (lang(?genreL) = \"fr\") .
    }

    # place
    OPTIONAL {
      ?item wdt:P276 [rdfs:label ?placeL] FILTER (lang(?placeL) = \"fr\") .
    }

    # arrondissement
    OPTIONAL {
      ?item wdt:P131 [wdt:P131 wd:Q90 ; rdfs:label ?arrL] FILTER (lang(?arrL) = \"fr\").
      BIND(REPLACE(?arrL, '^([0-9]+).*$', \"$1\", \"si\") AS ?arr)
    }

    # image
    OPTIONAL { ?item wdt:P18 ?img }

    # coordinates
    OPTIONAL { ?item wdt:P625 ?coord }

} GROUP BY ?item""" .
