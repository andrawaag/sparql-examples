@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix schema: <https://schema.org/> .

<https://www.wikidata.org/#query-dce4ba94f22da537564cdf44a3645674> a sh:SPARQLExecutable,
    sh:SPARQLSelectExecutable;
  rdfs:comment " "@en;
  dcterms:isPartOf <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/lb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/nl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/en-gb>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/hy>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/bo>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/yue>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/be-tarask>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/zh>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/he>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/tr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/eo>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/da>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/id>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/sr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/sv>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/ca>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/pl>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/de>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/ar>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/el>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/ja>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/it>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/es>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/ru>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/uk>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/fr>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views/en>,
    <https://www.wikidata.org//wiki/Wikidata:SPARQL_query_service/Wikidata_Query_Help/Result_Views>;
  dcterms:license <https://creativecommons.org/licenses/by-sa/4.0/>;
  sh:prefixes _:genid-4e694113159d4e3db4a1a913894a81d835477-wikidata_prefixes, _:genid-4e694113159d4e3db4a1a913894a81d835477-A4734F3F0CE6A07079652E784BD427F1,
    _:genid-4e694113159d4e3db4a1a913894a81d835477-ADD540BD5F01F545A22C2DB2C2C88C31, _:genid-4e694113159d4e3db4a1a913894a81d835477-C8C4EC0B6949CC16FD69CF2C84475B65,
    _:genid-4e694113159d4e3db4a1a913894a81d835477-C14E81B772D9C00D2BD3C53BFF5F0408, _:genid-4e694113159d4e3db4a1a913894a81d835477-DAF6ADA2521CC1FD71D5631EC6C4A68B,
    _:genid-4e694113159d4e3db4a1a913894a81d835477-7280229F56F97EDE3F6BE3AB7B27AA59, _:genid-4e694113159d4e3db4a1a913894a81d835477-66CA769CDEA4F60BC63468C47DF3CDED,
    _:genid-4e694113159d4e3db4a1a913894a81d835477-FC8E35A585612953171013650FDCDEB2, _:genid-4e694113159d4e3db4a1a913894a81d835477-38BF05D81AB0F2C73D1D46868D80ADA2,
    _:genid-4e694113159d4e3db4a1a913894a81d835477-724A95B473AADA0E1FD89207B1DFCC1F, _:genid-4e694113159d4e3db4a1a913894a81d835477-D0778CF6C3D3E883BB98E9AC8F7BEF5E,
    _:genid-4e694113159d4e3db4a1a913894a81d835477-5AD79222B37631A0C1BA6B07301184EB, _:genid-4e694113159d4e3db4a1a913894a81d835477-127F3E7D1E6BDB86DD9D5816090C6438,
    _:genid-4e694113159d4e3db4a1a913894a81d835477-0D946760972AE599399DC4368529D962, _:genid-4e694113159d4e3db4a1a913894a81d835477-E473C33484C7D0EDFA7674285C6C0463,
    _:genid-4e694113159d4e3db4a1a913894a81d835477-B5B6F4C40D5DDFD9FF125A3E2CA798F8, _:genid-4e694113159d4e3db4a1a913894a81d835477-66D64B7690531B664FA931CBDDFF5E34,
    _:genid-4e694113159d4e3db4a1a913894a81d835477-4758726468EA58DBEA90455946DA03D8, _:genid-4e694113159d4e3db4a1a913894a81d835477-79B7667DB1D08FEA6B9802DDE4EA2BF3,
    _:genid-4e694113159d4e3db4a1a913894a81d835477-141D86FBF1768CC0B067C231C201C59C, _:genid-4e694113159d4e3db4a1a913894a81d835477-001C7A4A13BAC51036EC6D17CCD0D85D,
    _:genid-4e694113159d4e3db4a1a913894a81d835477-953D89BE474B1DC3CD159C36846098B8, _:genid-4e694113159d4e3db4a1a913894a81d835477-938F56F9DEB4659372F6D46C7E623B37,
    _:genid-4e694113159d4e3db4a1a913894a81d835477-5C1BD3EDDAE0AEC826BC57D26EDB4F39, _:genid-4e694113159d4e3db4a1a913894a81d835477-32A06BA80AF23C8D1F457B83CA0EE63F,
    _:genid-4e694113159d4e3db4a1a913894a81d835477-7C3C3F56FCFCF531F5A49EA989C39F05, _:genid-4e694113159d4e3db4a1a913894a81d835477-BF1A0827B604F3C67B3CDC1950915D5D;
  schema:target <https://query.wikidata.org/sparql/>;
  sh:select """PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX wd: <http://www.wikidata.org/entity/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
# Recent events
SELECT ?event ?eventLabel ?date
WHERE
{
  # find events
  ?event wdt:P31/wdt:P279* wd:Q1190554.
  # with a point in time or start date
  OPTIONAL { ?event wdt:P585 ?date. }
  OPTIONAL { ?event wdt:P580 ?date. }
  # but at least one of those
  FILTER(BOUND(?date) && DATATYPE(?date) = xsd:dateTime).
  # not in the future, and not more than 31 days ago
  BIND(NOW() - ?date AS ?distance).
  FILTER(0 <= ?distance && ?distance < 31).
  # and get a label as well
  OPTIONAL {
    ?event rdfs:label ?eventLabel.
    FILTER(LANG(?eventLabel) = \"en\").
    }
}
# limit to 10 results so we don't timeout
LIMIT 10""" .
